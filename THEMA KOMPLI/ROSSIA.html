<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Deutsch B2 Pr√ºfung - Komplett</title>
  <style>
    /* ===== GLOBAL STYLES ===== */
    :root {
      --primary-color: #1e3a5f;
      --secondary-color: #2c5282;
      --accent-color: #4da6ff;
      --light-color: #ebf8ff;
      --text-color: #2d3748;
      --white: #ffffff;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s ease;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      margin: 0;
      min-height: 100vh;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: var(--white);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    button {
      cursor: pointer;
    }
    
    /* ===== START PAGE STYLES ===== */
    .start-container {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      padding: 20px;
      min-height: 100vh;
    }
    
    .start-content {
      max-width: 600px;
      width: 100%;
      background-color: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      border-radius: 16px;
      padding: 40px;
      box-shadow: var(--shadow);
      text-align: center;
      border: 1px solid rgba(255, 255, 255, 0.2);
    }
    
    .logo {
      margin-bottom: 20px;
    }
    
    .logo-icon {
      font-size: 48px;
      margin-bottom: 10px;
    }
    
    h1 {
      font-size: 32px;
      margin-bottom: 10px;
      font-weight: 700;
    }
    
    .subtitle {
      font-size: 18px;
      margin-bottom: 30px;
      opacity: 0.9;
    }
    
    .card {
      background-color: var(--white);
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: var(--shadow);
      color: var(--text-color);
    }
    
    .card h2 {
      font-size: 20px;
      margin-bottom: 15px;
      color: var(--primary-color);
    }
    
    .card p {
      margin-bottom: 20px;
      line-height: 1.5;
    }
    
    select {
      width: 100%;
      padding: 12px 16px;
      font-size: 16px;
      border-radius: 8px;
      border: 2px solid var(--accent-color);
      outline: none;
      background-color: var(--white);
      color: var(--text-color);
      cursor: pointer;
      transition: var(--transition);
    }
    
    select:focus {
      border-color: var(--secondary-color);
      box-shadow: 0 0 0 3px rgba(66, 153, 225, 0.3);
    }
    
    .timer-container {
      margin: 25px 0;
    }
    
    .timer-label {
      font-size: 16px;
      margin-bottom: 10px;
    }
    
    .timer {
      font-size: 48px;
      font-weight: 700;
      color: var(--accent-color);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
    
    .progress-bar {
      height: 8px;
      width: 100%;
      background-color: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 10px;
    }
    
    .progress {
      height: 100%;
      width: 100%;
      background-color: var(--accent-color);
      border-radius: 4px;
      transform: scaleX(1);
      transform-origin: left;
      transition: transform 1s linear;
    }
    
    .info-text {
      font-size: 14px;
      margin-top: 20px;
      opacity: 0.8;
    }
    
    .button-container {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }
    
    .btn {
      flex: 1;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      background-color: var(--accent-color);
      color: white;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }
    
    .btn:hover {
      background-color: #3399ff;
    }
    
    /* ===== EXAM PAGE STYLES ===== */
    .exam-body {
      background: #f5f5f5;
      color: #333;
      line-height: 1.45;
      -webkit-font-smoothing: antialiased;
    }
    
    /* Header Styles */
    header.topbar {
      background: #1e3a5f;
      color: #fff;
      padding: 12px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      min-height: 80px;
    }

    .brand {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .brand .logo {
      width: 80px;
      height: 40px;
      background: #e74c3c;
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      color: white;
      font-size: 18px;
    }

    .meta .main-title {
      font-weight: 800;
      font-size: 18px;
    }

    .meta .sub-title {
      font-size: 13px;
      opacity: 0.9;
    }

    .timer {
      font-weight: 700;
      font-size: 18px;
      color: #fff;
      margin: 0 20px;
    }

    .buttons-grid {
      display: grid;
      grid-template-columns: repeat(2, auto);
      gap: 10px 20px;
    }

    .exam-btn {
      padding: 12px 20px;
      border-radius: 6px;
      border: none;
      background: #4da6ff;
      color: white;
      font-weight: 700;
      font-size: 15px;
      cursor: pointer;
      transition: background 0.2s ease-in-out;
      min-width: 150px;
      text-align: center;
    }

    .exam-btn:hover {
      background: #336fbf;
    }
    
    .exam-btn.save {
      background: #4da6ff;
      color: #000;
    }
    
    .exam-btn.save:hover {
      background: #3399ff;
    }
    
    .exam-btn.submit {
      background: #4da6ff;
    }
    
    .exam-btn.submit:hover {
      background: #3399ff;
    }
    
    .exam-btn.result {
      background: #4da6ff;
    }
    
    .exam-btn.result:hover {
      background: #3399ff;
    }
    
    .exam-btn.next {
      background: #4da6ff;
      color: #fff;
    }
    
    .exam-btn.next:hover {
      background: #3399ff;
    }
    
    .exam-btn.reset {
      background: #4da6ff;
    }
    
    .exam-btn.reset:hover {
      background: #3399ff;
    }
    
    .exam-btn.reset-section {
      background: #d35400;
      font-size: 12px;
      padding: 6px 10px;
      min-width: auto;
    }
    
    .exam-btn.reset-section:hover {
      background: #e67e22;
    }
    
    .exam-btn.no-match {
      background: #95a5a6;
      font-size: 12px;
      padding: 6px 10px;
      min-width: auto;
      margin-top: 5px;
    }
    
    .exam-btn.no-match:hover {
      background: #7f8c8d;
    }
    
    .exam-btn.no-match.selected {
      background: #e74c3c;
    }
    
    /* Top Tiles */
    .top-tiles {
      display: flex;
      justify-content: center;
      gap: 8px;
      padding: 8px 12px;
      background: #1e3a5f;
      border-bottom: 1px solid #0f223a;
    }
    
    .tile {
      flex: 1;
      max-width: 180px;
      text-align: center;
      padding: 12px;
      border-radius: 6px;
      border: 1px solid #ccc;
      background: #3b4a63;
      color: #fff;
      font-weight: 600;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s ease-in-out;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 60px;
    }
    
    .tile:hover {
      background: #4a5b78;
    }
    
    .tile.active {
      background: #ffffff;
      color: #000;
      border-color: #bbb;
    }
    
    .tile.done {
      background: #2ecc71;
      color: #fff;
      border-color: #27ae60;
    }
    
    .tile.done::after {
      content: " ‚úÖ";
      margin-left: 5px;
    }
    
    .tile .points {
      background: rgba(255,255,255,0.2);
      padding: 4px 8px;
      border-radius: 12px;
      font-weight: 700;
      font-size: 11px;
      margin-top: 4px;
    }
    
    .tile.active .points {
      background: #e9eefc;
      color: #2c3e50;
    }
    
    /* Container Styles */
    .container {
      display: grid;
      grid-template-columns: 1fr 420px;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .container-full {
      display: grid;
      grid-template-columns: 1fr;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .container-split {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      padding: 16px;
      max-width: 1200px;
      margin: 12px auto;
    }
    
    .left-panel {
      background: white;
      border-radius: 8px;
      padding: 18px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      max-height: 76vh;
      overflow: auto;
    }
    
    .left-panel .passage {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.8;
    }
    
    .left-panel h2 {
      font-size: 16px;
      margin-bottom: 10px;
    }
    
    .right-panel {
      background: white;
      border-radius: 8px;
      padding: 12px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      display: flex;
      flex-direction: column;
      gap: 12px;
      max-height: 76vh;
      overflow: auto;
    }
    
    .main-panel {
      background: white;
      border-radius: 8px;
      padding: 25px;
      box-shadow: 0 1px 6px rgba(0,0,0,0.06);
      max-height: 76vh;
      overflow: auto;
    }
    
    .panel-title {
      font-size: 18px;
      margin-bottom: 15px;
      color: #1e3a5f;
      font-weight: 700;
    }
    
    /* Question Styles */
    .question-head {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }
    
    .question-body {
      margin-top: 8px;
    }
    
    .options {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .option {
      background: #fbfdff;
      border: 1px solid #e1e8f6;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .option:hover {
      background: #f0f6ff;
    }
    
    .option.selected {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .option .radio {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 2px solid #cfdff6;
      background: #fff;
      display: inline-block;
      flex-shrink: 0;
    }
    
    .option.selected .radio {
      background: #3498db;
      border-color: #3498db;
      box-shadow: inset 0 -3px 0 rgba(0,0,0,0.05);
    }
    
    .text-container {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
      position: relative;
      min-height: 120px;
    }
    
    .text-container:hover {
      background: #f0f6ff;
    }
    
    .text-title {
      font-weight: 700;
      margin-bottom: 8px;
      color: #2c3e50;
    }
    
    .text-content {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.6;
    }
    
    .title-slot {
      min-height: 40px;
      margin-top: 10px;
      padding: 8px;
      border: 2px dashed #c8d9f6;
      border-radius: 6px;
      background: #f8fbff;
    }
    
    .title-slot.has-title {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .title-slot.has-x {
      background: #f8d7da;
      border-color: #e74c3c;
      color: #c0392b;
      font-weight: bold;
    }
    
    .headings-bank {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 0;
    }
    
    .heading-item {
      padding: 10px;
      border: 1px solid #dbe7fb;
      border-radius: 8px;
      background: #f8fbff;
      cursor: grab;
    }
    
    .heading-item:hover {
      background: #e9f0ff;
    }
    
    .heading-item.used {
      opacity: 0.5;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
    }
    
    .result-correct {
      color: #27ae60;
      font-weight: bold;
    }
    
    .result-incorrect {
      color: #c0392b;
      font-weight: bold;
    }
    
    .result-item {
      margin: 10px 0;
      padding: 10px;
      border-radius: 6px;
      background: #f8f9fa;
      border: 1px solid #e1e8f6;
    }
    
    .instructions {
      color: #7f8c8d;
      font-size: 14px;
      line-height: 1.6;
      margin-bottom: 15px;
    }
    
    .question-text {
      font-weight: 600;
      margin-bottom: 15px;
      font-size: 15px;
      color: #2c3e50;
    }
    
    .all-questions {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    
    .question-block {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .texts-list, .situations-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .text-item, .situation-item {
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .text-letter {
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 8px;
    }
    
    .situation-number {
      font-weight: bold;
      color: #2c3e50;
      margin-bottom: 8px;
    }
    
    .fill-blank-container {
      margin: 20px 0;
    }
    
    .blank-word {
      display: inline-block;
      min-width: 120px;
      padding: 4px 8px;
      margin: 0 6px;
      background: #fff;
      cursor: pointer;
      position: relative;
      border: 1px solid #dbe7fb;
      border-radius: 4px;
    }
    
    .blank-word.has-answer {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .options-popup {
      position: absolute;
      top: 100%;
      left: 0;
      background: white;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      z-index: 100;
      min-width: 150px;
    }
    
    .option-item {
      padding: 8px 12px;
      cursor: pointer;
      border-bottom: 1px solid #f0f4fb;
    }
    
    .option-item:hover {
      background: #f0f6ff;
    }
    
    .option-item:last-child {
      border-bottom: none;
    }
    
    .horizontal-options {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .option-row {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 10px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .option-number {
      font-weight: bold;
      color: #2c3e50;
      min-width: 30px;
    }
    
    .option-buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    
    .option-btn {
      padding: 8px 16px;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      background: #f8fbff;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .option-btn:hover {
      background: #e9f0ff;
    }
    
    .option-btn.selected {
      background: #3498db;
      color: white;
      border-color: #3498db;
    }
    
    .word-bank-vertical {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    
    .bank-word-vertical {
      padding: 10px;
      border: 1px solid #dbe7fb;
      border-radius: 6px;
      background: #f8fbff;
      text-align: center;
      cursor: grab;
    }
    
    .bank-word-vertical.used {
      opacity: 0.5;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
    }
    
    .blank-slot {
      display: inline-block;
      min-width: 100px;
      padding: 4px 8px;
      margin: 0 6px;
      background: #fff;
      min-height: 30px;
      vertical-align: middle;
      border: 1px solid #dbe7fb;
      border-radius: 4px;
      cursor: pointer;
    }
    
    .blank-slot.has-answer {
      background: #e8fbe9;
      border-color: #2ecc71;
    }
    
    .footer-buttons {
      display: flex;
      gap: 10px;
    }
    
    .situation-item.used {
      opacity: 0.7;
      cursor: not-allowed;
      background: #f8d7da;
      border-color: #f5c6cb;
      color: #333;
    }
    
    /* Listening Section Styles */
    .listening-task {
      margin-bottom: 10px;
    }
    
    .true-false-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      font-size: 14px;
    }
    
    .true-false-table th {
      background: #3498db;
      color: white;
      padding: 15px;
      text-align: left;
      font-weight: 600;
      font-size: 14px;
    }
    
    .true-false-table td {
      padding: 15px;
      border-bottom: 1px solid #e1e8f6;
      vertical-align: top;
    }
    
    .true-false-table tr:nth-child(even) {
      background: #f8f9fa;
    }
    
    .true-false-table tr:hover {
      background: #e3f2fd;
    }
    
    .answer-options {
      display: flex;
      gap: 25px;
    }
    
    .answer-option {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      padding: 10px 15px;
      border-radius: 4px;
      transition: background 0.2s;
      font-weight: 500;
    }
    
    .answer-option:hover {
      background: #e3f2fd;
    }
    
    .answer-option input {
      margin: 0;
      transform: scale(1.2);
    }

    .correct-answer {
      background: #d4edda !important;
      border-left: 4px solid #28a745;
    }
    
    .incorrect-answer {
      background: #f8d7da !important;
      border-left: 4px solid #dc3545;
    }
    
    /* Writing Section Styles */
    .writing-task {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #e1e8f6;
      border-radius: 8px;
      background: #fbfdff;
    }
    
    .writing-prompt {
      font-size: 14px;
      color: #2c3e50;
      line-height: 1.6;
      margin-bottom: 15px;
    }
    
    .writing-requirements {
      background: #f8f9fa;
      padding: 12px;
      border-radius: 6px;
      border-left: 4px solid #3498db;
      margin-bottom: 15px;
    }
    
    .writing-requirements h4 {
      margin: 0 0 8px 0;
      color: #2c3e50;
    }
    
    .writing-requirements ul {
      margin: 0;
      padding-left: 20px;
    }
    
    .writing-requirements li {
      margin-bottom: 5px;
      color: #2c3e50;
    }
    
    .writing-area {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .writing-textarea {
      flex: 1;
      min-height: 500px;
      padding: 15px;
      border: 2px solid #e1e8f6;
      border-radius: 8px;
      font-size: 14px;
      line-height: 1.6;
      resize: vertical;
      font-family: Arial, sans-serif;
    }
    
    .writing-textarea:focus {
      outline: none;
      border-color: #3498db;
    }
    
    .word-counter {
      margin-top: 10px;
      text-align: right;
      font-size: 13px;
      color: #7f8c8d;
      padding: 8px 0;
    }
    
    .word-counter .count {
      font-weight: bold;
      color: #2c3e50;
    }
    
    /* Results Page Styles */
    .results-body {
      background: #f7fafc;
      color: #0f1724;
      line-height: 1.6;
    }
    
    .results-header {
      background: #1e3a5f;
      color: #fff;
      padding: 18px 20px;
      display: flex;
      align-items: center;
      gap: 16px;
    }
    
    .results-logo {
      background: #fff;
      color: #1e3a5f;
      padding: 8px 12px;
      border-radius: 6px;
      font-weight: 800;
    }
    
    .results-title {
      font-size: 18px;
      font-weight: 700;
    }
    
    .results-container {
      max-width: 1100px;
      margin: 22px auto;
      padding: 20px;
    }
    
    .results-tiles {
      display: flex;
      gap: 12px;
      margin: 18px 0;
    }
    
    .results-tile {
      flex: 1;
      background: #fff;
      border-radius: 10px;
      padding: 16px;
      box-shadow: 0 6px 18px rgba(2, 6, 23, 0.06);
      border-left: 6px solid #1e3a5f;
      text-align: center;
    }
    
    .results-tile h3 {
      margin: 0;
      font-size: 16px;
      color: #1e3a5f;
    }
    
    .results-tile .score {
      font-size: 20px;
      font-weight: 800;
      margin-top: 8px;
    }
    
    .section-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 12px;
    }
    
    .section-table th,
    .section-table td {
      padding: 8px;
      border-bottom: 1px solid #e6eef8;
      text-align: left;
      font-size: 14px;
    }
    
    .summary {
      background: #fff;
      padding: 16px;
      border-radius: 10px;
      margin-top: 18px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .summary .left {
      font-weight: 700;
    }
    
    .summary .right {
      text-align: right;
    }
    
    .controls {
      display: flex;
      gap: 10px;
      margin-top: 18px;
    }
    
    .results-btn {
      background: #4da6ff;
      border: none;
      color: #fff;
      padding: 10px 14px;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.3s;
    }
    
    .results-btn:hover {
      background: #3a8ce0;
    }
    
    .button-like {
      text-decoration: none;
    }
    
    .small-muted {
      color: #6b7280;
      font-size: 13px;
    }
    
    input[type="number"] {
      width: 90px;
      padding: 8px;
      border: 1px solid #d7e6fb;
      border-radius: 6px;
    }
    
    .note {
      font-size: 13px;
      color: #6b7280;
      margin-top: 8px;
    }
    
    /* Footer */
    footer.controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: white;
      border-top: 1px solid #e1e8f6;
      margin-top: 20px;
    }
    
    .status {
      font-size: 14px;
      color: #7f8c8d;
    }
    
    .ghost {
      background: transparent;
      border: 2px solid #2c3e50;
      color: #2c3e50;
    }
    
    .ghost:hover {
      background: #2c3e50;
      color: white;
    }

    /* Responsive Styles */
    @media (max-width: 980px) {
      .container {
        grid-template-columns: 1fr;
        padding: 12px;
      }
      
      .container-split {
        grid-template-columns: 1fr;
      }
      
      .right-panel {
        order: 2;
      }
      
      .top-tiles {
        padding-left: 8px;
        padding-right: 8px;
      }
      
      header.topbar {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }
      
      .buttons-grid {
        grid-template-columns: 1fr;
      }
      
      .answer-options {
        flex-direction: column;
        gap: 10px;
      }
      
      footer.controls {
        flex-direction: column;
        gap: 15px;
      }
      
      .results-tiles {
        flex-direction: column;
      }
      
      .summary {
        flex-direction: column;
        gap: 10px;
        text-align: center;
      }
      
      .controls {
        flex-direction: column;
      }
    }
    
    @media (max-width: 600px) {
      .start-content {
        padding: 25px 20px;
      }
      
      h1 {
        font-size: 28px;
      }
      
      .card {
        padding: 20px 15px;
      }
    }

    /* === ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ÿÆÿßÿµÿ© ŸÑŸÑŸáŸàÿßÿ™ŸÅ ÿßŸÑÿµÿ∫Ÿäÿ±ÿ© ÿ¨ÿØÿß === */
    @media (max-width: 480px) {
      /* 1. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ≠ÿßŸàŸäÿßÿ™ ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ© */
      .container, .container-split, .container-full {
        grid-template-columns: 1fr !important;
        padding: 8px !important;
        gap: 10px !important;
      }
      
      /* 2. ÿ¨ÿπŸÑ ÿßŸÑŸÑŸàÿ≠ÿßÿ™ (panels) ÿ™ÿ£ÿÆÿ∞ ÿπÿ±ÿ∂ ŸÉÿßŸÖŸÑ */
      .left-panel, .right-panel, .main-panel {
        max-height: none !important;
        height: auto !important;
        overflow: visible !important;
        margin-bottom: 10px;
      }
      
      /* 3. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸáŸäÿØÿ± */
      .topbar {
        flex-direction: column !important;
        align-items: stretch !important;
        padding: 10px !important;
      }
      
      .brand {
        justify-content: center;
        margin-bottom: 10px;
      }
      
      /* 4. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ£ÿ≤ÿ±ÿßÿ± ŸÅŸä ÿßŸÑŸáŸäÿØÿ± */
      .buttons-grid {
        grid-template-columns: 1fr !important;
        width: 100%;
      }
      
      .exam-btn {
        width: 100% !important;
        margin: 2px 0 !important;
        font-size: 14px !important;
        padding: 12px 8px !important;
      }
      
      /* 5. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿ™ÿßŸäŸÑÿßÿ™ */
      .top-tiles {
        flex-wrap: wrap;
        justify-content: center;
      }
      
      .tile {
        flex: 0 0 calc(33% - 5px) !important;
        max-width: calc(33% - 5px) !important;
        margin: 2px;
        font-size: 11px !important;
        padding: 8px 4px !important;
      }
      
      /* 6. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÜÿµŸàÿµ */
      .passage, .text-content, .question-text {
        font-size: 15px !important;
        line-height: 1.5 !important;
      }
      
      /* 7. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑÿÆŸäÿßÿ±ÿßÿ™ */
      .option {
        padding: 12px 10px !important;
        margin: 4px 0 !important;
      }
      
      /* 8. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿ¨ÿØÿßŸàŸÑ True/False */
      .true-false-table {
        display: block;
        overflow-x: auto;
        white-space: nowrap;
      }
      
      /* 9. ÿ™ÿ≠ÿ≥ŸäŸÜ ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑŸÉÿ™ÿßÿ®ÿ© */
      .writing-textarea {
        min-height: 300px !important;
        font-size: 16px !important;
      }
      
      /* 10. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÅŸàÿ™ÿ± */
      footer.controls {
        flex-direction: column !important;
        gap: 10px !important;
      }
      
      .footer-buttons {
        width: 100%;
        display: flex;
        gap: 5px;
      }
      
      .footer-buttons .exam-btn {
        flex: 1;
      }
      
      /* 11. ÿ™ÿ≠ÿ≥ŸäŸÜ ÿßŸÑŸÜÿ™ÿßÿ¶ÿ¨ */
      .results-tiles {
        flex-direction: column !important;
      }
      
      .results-tile {
        margin-bottom: 10px;
      }
    }

    /* === ÿ™ÿ≠ÿ≥ŸäŸÜÿßÿ™ ŸÑŸÑŸáŸàÿßÿ™ŸÅ ÿßŸÑŸÖÿ™Ÿàÿ≥ÿ∑ÿ© === */
    @media (min-width: 481px) and (max-width: 768px) {
      .container, .container-split {
        grid-template-columns: 1fr !important;
      }
      
      .tile {
        max-width: 180px !important;
      }
    }
  </style>
</head>
<body id="body">
  <!-- Start Page -->
  <div id="start-page" class="start-container">
    <div class="start-content">
      <div class="logo">
        <div class="logo-icon">üìù</div>
        <h1>Deutsch B2 Pr√ºfung</h1>
        <div class="subtitle">Bereiten Sie sich auf Ihre Pr√ºfung vor</div>
      </div>
      <div class="card">
        <h2>Pr√ºfungsbereich ausw√§hlen</h2>
        <p>W√§hlen Sie bitte den Bereich aus, den Sie √ºben m√∂chten. Die Pr√ºfung startet automatisch in <span id="time-display">30</span> Sekunden.</p>
        <select id="sectionSelect">
          <option value="lesen">Lesen</option>
          <option value="hoeren">H√∂ren</option>
          <option value="schreiben">Schreiben</option>
        </select>
        <div class="button-container">
          <button id="cancelBtn" class="btn">Abbrechen</button>
          <button id="startBtn" class="btn">Jetzt starten</button>
        </div>
      </div>
      <div class="timer-container">
        <div class="timer-label">Die Pr√ºfung startet in:</div>
        <div class="timer" id="countdown">30</div>
        <div class="progress-bar">
          <div class="progress" id="progress"></div>
        </div>
      </div>
      <div class="info-text">Stellen Sie sicher, dass Sie in einer ruhigen Umgebung sind und gen√ºgend Zeit haben.</div>
    </div>
  </div>

  <!-- Lesen Page -->
  <div id="lesen-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">Lesen ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-lesen" class="timer" aria-live="polite">Verbleibende Zeit: 90:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-lesen" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-lesen" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-lesen" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-lesen" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-lesen">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-lesen" role="navigation" aria-label="Sections overview"></div>

    <div class="container">
      <main class="left-panel" id="leftPanel-lesen">
        <div class="passage" id="passage-lesen">
          <h2 id="passageTitle-lesen">Aufgabe</h2>
          <div id="passageContent-lesen"></div>
        </div>
      </main>

      <aside class="right-panel" id="rightPanel-lesen" aria-labelledby="questionTitle-lesen">
        <div class="question-head">
          <div>
            <div id="sectionName-lesen" style="font-weight:800"></div>
            <div id="questionTitle-lesen" style="font-size:13px;color:#55607a">Frage</div>
          </div>
          <button id="resetSectionBtn-lesen" class="exam-btn reset-section" style="display:none;">Teil zur√ºcksetzen</button>
        </div>
        <div class="question-body" id="questionBody-lesen"></div>
        <div id="headingsBankContainer-lesen"></div>
      </aside>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-lesen" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-lesen-footer" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-lesen">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- H√∂ren Page -->
  <div id="hoeren-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">H√∂rverstehen ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-hoeren" class="timer" aria-live="polite">Verbleibende Zeit: 17:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-hoeren" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-hoeren" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-hoeren" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-hoeren" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-hoeren">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-hoeren" role="navigation" aria-label="Sections overview"></div>

    <div class="container-full">
      <main class="main-panel" id="mainPanel-hoeren">
        <div id="contentContainer-hoeren"></div>
      </main>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-hoeren" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-hoeren-footer" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-hoeren">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- Schreiben Page -->
  <div id="schreiben-page" class="exam-page" style="display: none;">
    <header class="topbar" role="banner">
      <div class="brand">
        <div class="logo">test</div>
        <div class="meta">
          <div class="main-title">Deutsch - B2 (√úbung)</div>
          <div class="sub-title">Schreiben ‚Äî Testbeispiel</div>
        </div>
      </div>

      <div id="timer-schreiben" class="timer" aria-live="polite">Verbleibende Zeit: 30:00</div>

      <div class="buttons-grid">
        <button id="resetBtn-schreiben" class="exam-btn reset">üîÑ Von neu beginnen</button>
        <button id="saveBtn-schreiben" class="exam-btn save">üìã Speichern</button>
        <button id="resultBtn-schreiben" class="exam-btn result">üìä Ergebnis</button>
        <button id="submitBtn-schreiben" class="exam-btn submit">üèÅ Abgabe</button>
        <button class="exam-btn next" id="nextBtn-schreiben">‚û°Ô∏è N√§chste Pr√ºfung</button>
      </div>
    </header>

    <div class="top-tiles" id="topTiles-schreiben" role="navigation" aria-label="Sections overview"></div>

    <div class="container-split">
      <main class="left-panel" id="leftPanel-schreiben">
        <div class="passage" id="passage-schreiben">
          <h2 id="passageTitle-schreiben">Aufgabe</h2>
          <div id="passageContent-schreiben"></div>
        </div>
      </main>

      <aside class="right-panel" id="rightPanel-schreiben">
        <div id="writingContainer-schreiben"></div>
      </aside>
    </div>

    <footer class="controls">
      <div class="footer-buttons">
        <button id="prevBtn-schreiben" class="exam-btn ghost">Zur√ºck</button>
        <button id="nextBtn-schreiben-footer" class="exam-btn ghost">Weiter</button>
      </div>
      <div class="status"><span id="statusText-schreiben">Nicht gespeichert</span></div>
    </footer>
  </div>

  <!-- Ergebnisse Page -->
  <div id="ergebnisse-page" class="results-page" style="display: none;">
    <header class="results-header">
      <div class="results-logo">test</div>
      <div class="results-title">Gesamtergebnis ‚Äî Deutsch B2</div>
    </header>

    <div class="results-container">
      <div class="results-tiles" id="topTiles-ergebnisse"></div>
      <div id="details-ergebnisse"></div>
      <div class="summary" id="finalSummary-ergebnisse"></div>
      <div class="controls">
        <a class="button-like" href="#" id="backBtn-ergebnisse">
          <button class="results-btn">üîÅ Zur√ºck zur Startseite</button>
        </a>
        <button id="calcBtn-ergebnisse" class="results-btn">‚úÖ Ergebnisse anzeigen</button>
      </div>
      <div class="note">Hinweis: Schreiben (45 Punkte) wird manuell eingegeben, falls nicht automatisch vorhanden.</div>
    </div>
  </div>

  <script>
    // ===== PAGE NAVIGATION =====
    function showPage(pageId) {
      // Hide all pages
      document.getElementById('start-page').style.display = 'none';
      document.getElementById('lesen-page').style.display = 'none';
      document.getElementById('hoeren-page').style.display = 'none';
      document.getElementById('schreiben-page').style.display = 'none';
      document.getElementById('ergebnisse-page').style.display = 'none';
      
      // Change body class based on page
      document.getElementById('body').className = '';
      if (pageId === 'ergebnisse-page') {
        document.getElementById('body').className = 'results-body';
      } else if (pageId !== 'start-page') {
        document.getElementById('body').className = 'exam-body';
      }
      
      // Show selected page
      document.getElementById(pageId).style.display = 'block';
      
      // Initialize the page if needed
      if (pageId === 'lesen-page') {
        initLesenPage();
      } else if (pageId === 'hoeren-page') {
        initHoerenPage();
      } else if (pageId === 'schreiben-page') {
        initSchreibenPage();
      } else if (pageId === 'ergebnisse-page') {
        initErgebnissePage();
      }
    }

    // ===== START PAGE FUNCTIONALITY =====
    let initialCounter = 30;
    let counter = initialCounter;
    let countdownInterval = null;
    let countdownRunning = false;
    let examStarted = false;
    
    function startCountdown() {
      if (countdownRunning || examStarted) return;
      
      countdownRunning = true;
      counter = initialCounter;
      
      const timerEl = document.getElementById("countdown");
      const timeDisplayEl = document.getElementById("time-display");
      const progressEl = document.getElementById("progress");
      const startBtn = document.getElementById("startBtn");
      
      if (startBtn) startBtn.disabled = true;
      
      timerEl.textContent = counter;
      if (timeDisplayEl) timeDisplayEl.textContent = counter;
      if (progressEl) progressEl.style.transform = "scaleX(0)";
      timerEl.style.color = "";

      countdownInterval = setInterval(() => {
        counter--;
        timerEl.textContent = counter;
        if (timeDisplayEl) timeDisplayEl.textContent = counter;
        if (progressEl) {
          const progressValue = (initialCounter - counter) / initialCounter;
          progressEl.style.transform = `scaleX(${progressValue})`;
        }
        
        if (counter <= 0) {
          clearInterval(countdownInterval);
          countdownInterval = null;
          countdownRunning = false;
          if (progressEl) progressEl.style.transform = "scaleX(1)";
          
          if (!examStarted) {
            examStarted = true;
            startExam();
          }
          
          if (startBtn) {
            startBtn.disabled = false;
            startBtn.removeAttribute('aria-disabled');
          }
        }
      }, 1000);
    }

    function stopCountdown(reset = true) {
      if (countdownInterval) {
        clearInterval(countdownInterval);
        countdownInterval = null;
      }
      countdownRunning = false;
      
      const startBtn = document.getElementById("startBtn");
      const progressEl = document.getElementById("progress");
      const timerEl = document.getElementById("countdown");
      const timeDisplayEl = document.getElementById("time-display");
      
      if (startBtn) {
        startBtn.disabled = false;
        startBtn.removeAttribute('aria-disabled');
      }
      
      if (progressEl) progressEl.style.transform = "scaleX(0)";
      
      if (reset) {
        counter = initialCounter;
        timerEl.textContent = counter;
        if (timeDisplayEl) timeDisplayEl.textContent = counter;
      } else {
        timerEl.textContent = "Gestoppt";
      }
    }

    function startExam() {
      if (!examStarted) examStarted = true;
      
      const selectEl = document.getElementById("sectionSelect");
      const selectedSection = selectEl ? selectEl.value : 'lesen';
      
      if (selectedSection === 'lesen') {
        showPage('lesen-page');
      } else if (selectedSection === 'hoeren') {
        showPage('hoeren-page');
      } else if (selectedSection === 'schreiben') {
        showPage('schreiben-page');
      }
    }

    // Setup start page event listeners
    function initStartPage() {
      const startBtn = document.getElementById("startBtn");
      const cancelBtn = document.getElementById("cancelBtn");
      
      if (startBtn) {
        startBtn.addEventListener('click', startCountdown);
      }
      
      if (cancelBtn) {
        cancelBtn.addEventListener('click', function() {
          stopCountdown(true);
          const timerEl = document.getElementById("countdown");
          if (timerEl) {
            timerEl.textContent = "Abgebrochen";
            timerEl.style.color = "#e53e3e";
          }
        });
      }
    }

    // Call initialization when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      initStartPage();
    });

    // ===== LESEN PAGE FUNCTIONALITY =====
    function initLesenPage() {
      const exam = {
        id: "exam-001",
        durationSec: 90 * 60,
        sections: [
          { 
            id: "s1", 
            title: "Leseverstehen, Teil 1", 
            points: 25,
            passageTitle: "Aufgabe: Ziehen Sie die passenden √úberschriften auf die Texte.",
            passage: "",
            questions: [],
            texts: [
              {
                id: "text1",
                content: "In Russland 1843 als Tochter eines Bauern geboren, schafte es Nadeschda Suslowe ins Gymnasium. Mit 16 Jahren erhielt sie ihr Diplom als Hauslehrerin. Das war der h√∂chste Abschluss, den eine Frau damals in Russland erreichen konnte. Doch Nadeschda wollte mehr. Die junge Frau wollte √Ñrztin werden. Weil es ihr in Russland aber nicht erlaubt war, eine Hochschule zu besuchen, ging sie ins Ausland. An der Universit√§t Z√ºrich konnten Frauen schon seit einigen Jahren Vorlesungen besuchen. Nadeschda Suslowa war die erste Frau, die sich ordentlich an der Universit√§t einschreiben durfte, und gleichzeitig die erste Russin an der Z√ºricher Universit√§t. Am 14. Dezember 1867 machte die damals 24-J√§hrige ihr Examen. Sie war die erste promovierte √Ñrztin in der Schweiz und in Russland. ‚ÄûIch bin die Erste, aber nicht die Letzte. Nach mir werden Tausende kommen.‚Äú Davon war sie √ºberzeugt, und sie sollte recht behalten. Nach ihrem Abschluss ging sie zur√ºck nach Russland und gr√ºndete dort eine eigene Praxis f√ºr Frauen- und Kinderheilkunde.",
                correctAnswer: "c"
              },
              {
                id: "text2", 
                content: "Dass Frauen w√§hlen und gew√§hlt werden d√ºrfen, ist heutzutage selbstverst√§ndlich. Doch das war nicht immer so. √úberall auf der Welt mussten sie lange erbittert um ihr Wahlrecht streiten. In Europa war die Franz√∂sin Olympe de Gouges eine der ersten Frauen die sich aktiv f√ºr das Wahlrecht der B√ºrgerinnen einsetzten. Sie forderte zu Zeiten der Franz√∂sischen Revolution die rechtliche, politische und soziale Gleichstellung der Frau. Dies wurde zur Grundlage f√ºr die Einf√ºhrung des Frauenwahlrechts in Europa. Frankreich geh√∂rte allerdings nicht zu den ersten L√§ndern, in denen das Wahlrecht f√ºr Frauen realisiert wurde. Das geschah zuerst 1838 in der britischen Kolonie Pitcairn, einer Insel im s√ºdlichen Pazifik. Es folgten einzelne nordamerikanische Staaten, Neuseeland und S√ºdaustralien. In Europa erlangten die Frauen das Wahlrecht zuerst in Finnland, zu Beginn des 19. Jahrhunderts? In Frankreich, dem Heimatland von Olympe de Gouges, wurde es erst 1944 eingef√ºhrt. Als eines der letzten europ√§ischen L√§nder f√ºhrte die Schweiz das Frauenwahlrecht 1971 ein - durch eine Volksabstimmung der m√§nnlichen Bev√∂lkerung.",
                correctAnswer: "d"
              },
              {
                id: "text3",
                content: "Das Wahlverhalten von Frauen hat sich in den letzten Jahrzehnten ver√§ndert: In den 50er Jahren w√§hlten verheiratete Frauen oft noch so wie ihre M√§nner. Vor allem in der Mittelschicht zeigten sie eine deutliche Vorliebe f√ºr konservative Parteien. Die politischen Unruhen von 1968 hingegen hinterlie√üen ihre Spuren im Wahlverhalten der Frauen. Sie w√§hlten nun deutlich weniger konservativ und stimmten f√ºr Parteien, die sie in ihrem Anspruch auf Gleichberechtigung und Selbstst√§ndigkeit unterst√ºtzten.Auch heute w√§hlen M√§nner und Frauen in vielen L√§ndern unterschiedlich. Frauen scheinen f√ºr radikale Parteien weniger Sympathie aufzubringen als M√§nner, w√§hrend ihnen Gleichberechtigung ein gro√ües Anliegen ist. Die Sorge um die Umwelt schl√§gt sich in einem h√∂heren Anteil an Frauenstimmen f√ºr gr√ºne Parteien nieder. Frauen w√§hlen auch gerne Frauen. Deshalb geben sie ihre Stimmen bevorzugt Parteien, die mehr Kandidatinnen auf ihren Listen f√ºhren. Insgesamt scheint einiges darauf hinzudeuten, dass Frauen rationaler w√§hlen als M√§nner.",
                correctAnswer: "f"
              },
              {
                id: "text4",
                content: "In den vergangenen Jahrzehnten hat sich das Geschlechterverh√§ltnis bei Studierenden stark ver√§ndert. Nicht nur bei Studienanf√§ngern sind Frauen in der Mehrzahl, sondern auch unter jenen, die ein Hochschulstudium abschlie√üen. Doch das ist noch nicht alles: Weibliche Studierende absolvieren das Studium schneller als ihre Kommilitonen und schlieBen es auch h√§ufiger erfolgreich ab. Allerdings ist die Erfolgs- und Abschlussquote nicht in allen Studienrichtungen gleich. Am gr√∂√üten ist der Abstand beim Musikstudium: Mehr als 70 Prozent der Frauen schlie√üen es tats√§chlich ab, w√§hrend rund 50 Prozent der m√§nnlichen Studienanf√§nger es abbrechen. Unterschiedliche Erfolgsquoten der Geschlechter lassen sich an den meisten Universit√§ten beobachten; nur vereinzelt sind sie gleich hoch oder bei M√§nnern sogar etwas h√∂her. Warum das so ist, dar√ºber k√∂nnen Wissenschaftlervorerst nur Vermutungen anstellen. Die h√∂chsten Abschlussquoten erreichen √ºbrigens die Universit√§ten, f√ºr die es eine Zugangsbeschr√§nkung gibt. ",
                correctAnswer: "g"
              },
              {
                id: "text5",
                content: "Suffragetten so nannte man Anfang des 19. Jahrhunderts die Frauen, die sich in Gro√übritannien f√ºr das allgemeine Frauenwahlrecht einsetzten. Der Begriff kommt von suffrage, was im Franz√∂sischen und im Englischen Wahlrecht bedeutet. Emmeline P√•nkhurstund ihre T√∂chter z√§hlen zu den bekanntesten Pers√∂nlichkeiten der britischen Frauenbewegung. Sie setzten zun√§chst auf die Methode des passiven Widerstandes. Als der erhoffte Erfolg ausblieb und Gesetzes√§nder√ºngen abgelehnt wurden, griffen sie zu immer h√§rteren Mitteln, bis hin zu Brand- und Bombenanschl√§gen. Pankhurst wurde immer wieder verhatet und eingesperrt, lhr Kampf f√ºr das Wahlrecht der Frauen wurde durch den Ersten Weltkrieg unterbrochen. Nach Kriegsende bekamen Frauen ab 21 Jahren das Recht, zur Parlamentswahl anzutreten. Selbst w√§hlen durften sie allerdings erst ab 30. Dass Frauen dasselbe Wahlrecht Wie die M√§nner erhielten, erlebte Emmeline Pankhurst nicht mehr. Sie war drei Wochen vor dessen Einf√ºhrung am 2. Juli 1928 gestorben. ",
                correctAnswer: "i"
              }
            ],
            headings: [
              {id: "a", text: "Der heutige Anteil von Frauen im Medizinstudium"},
              {id: "b", text: "Die Frauen in der Franz√∂sischen Revolution"},
              {id: "c", text: "Eine Pionierin der akademischen Frauenausbildung"},
              {id: "d", text: "Entwicklung des Frauenstimmrechts"},
              {id: "e", text: "Frauen erreichen zunehmend bessere Noten im Studium"},
              {id: "f", text: "Geschlechtsspezifische Entscheidungen an der Wahlurne"},
              {id: "g", text: "STUDENTINNEN AUF DER √úBERHOLSPUR"},
              {id: "h", text: "Umfrage verspricht Erfolg der gr√ºnen Wahlkandidatin"},
              {id: "i", text: "Vork√§mpferinnen f√ºr das Frauenwahlrecht"},
              {id: "j", text: "Wieder Demonstrationen f√ºr freie Wahlen"}
            ]
          },
          { 
            id: "s2", 
            title: "Leseverstehen, Teil 2", 
            points: 25,
            passageTitle: "Wer parkt, muss zahlen Parkuhren in Deutschland",
            passage: `Es geschah am 1. Januar 1954. In Duisburg, einer Gro√üstadt am Rhein zwischen K√∂ln und der
niederl√§ndischen Grenze am Rande des Ruhrgebiets, gab es f√ºr die Autofahrer, die in der Stra√üe ‚ÄúAm Buchenbaum‚Äù ihre Autos parken wollten, eine √úberraschung. 20 etwa 1,5 Meter hohe Metallstangen mit uhrenf√∂rmigen Aufs√§tzen standen am Stra√üenrand mit der unmissverst√§ndlichen Aufschrift: ‚ÄúEinwurf 10 Pfennig f√ºr eine Stunde‚Äù. Die ersten Parkuhren in Deutschland waren aufgestellt. 
Nur Basel in der Schweiz und Stockholm in Schweden hatten vor Duisburg Parkuhren installiert, um Dauerparker aus den Stadtzentren zu vertreiben. Das eingenommene Geld wurde in Duisburg anfangs f√ºr gemeinn√ºtzige Zwecke ausgegeben: f√ºr Alte, Kranke Kriegsversehrte, f√ºr elternlose Kinder. Und die Stadtverwaltung war sich sicher, dass die Autofahrer Verst√§ndnis f√ºr die Parkuhren aufbringen w√ºrden, dienten sie doch einem guten Zweck. 
Doch bei den Autofahrenn war man nicht so erfreut √ºber diese neuen Apparate. ‚ÄúGroschengrab‚Äù wurden sie dann auch bald √ºberall genannt: ein Apparat, in den man Groschen - wie die 10-Pfennig-St√ºcke damals genannt wurden - hineinwarf. Dieser schluckte zwar gnadenlos Zehner, gab aber zum Verdruss vieler trotzdem oft keine Parkzeit frei. Tat er dies, dann aber in der Regel nur f√ºr h√∂chstens 60 Minuten. Viele Autofahrer waren au√üerdem ver√§rgert, weil sie immer passendes Kleingeld dabei haben mussten. Die ersten Parkuhren konnten n√§mlich nicht wechseln. 
Wer parkte, ohne zu zahlen, riskierte damals wie heute einen Strafbescheid, liebevoll ‚ÄúKn√∂llchen‚Äù genannt. In allen anderen deutschen St√§dten erschienen nach und nach auch Parkuhren. Bald geh√∂rten sie zu den Innenst√§dten wie das Rad zum Auto. Und das blieb so bis zum Ende der 1980er Jahre. 
Dann geschah so etwas wie eine Parkuhren-Revolution. Die guten, alten Parkuhren, die ein im Vergleich zu heute immer noch billiges Parken erlaubten, weil sie nicht beliebig oft auf neue Betr√§ge umgestellt werden konnten, wurden mehr und mehr ersetzt durch die gerade neu entwickelten Parkscheinautomaten. Mit Solarenergie angetrieben, computergesteuert und beliebig programmierbar machten sie es nun m√∂glich, ohne technische Beschr√§nkungen die Preise und Zeiten f√ºr das Parken flexibel zu gestalten. Von Vorteil ist auch ihre Kundenfreundlichkeit: Die Zeiten, in denen nur M√ºnzen als Zahlungsmittel akzeptiert wurden, sind pass√©; jetzt schlucken sie auch problemlos Papier- und Plastikgeld - und Wechselgeld wird ausgespuckt. 
Das Parken wurde immer teurer. Und l√§ngst dienten die eingenommenen Betr√§ge nicht mehr gemeinn√ºtzigen Zwecken. Sie wurden vielmehr als Einnahmequelle entdeckt f√ºr die leeren Stadtkassen, die nach immer mehr Geld verlangten. Gut 2 Millionen Euro verdient zum Beispiel Duisburg in einem Jahr an den Parkgeb√ºhren. In K√∂ln kommen etwa 10 Millionen Euro im Jahr zusammen. Noch einmal so viel Geld verdienen die St√§dte an den ‚ÄúKn√∂llchen‚Äù f√ºr falsches Parken. 
Aus 10 Pfennig f√ºr eine Stunde im Jahr 1954 - das w√§ren heute etwa 5 Cents - sind inzwischen weit h√∂here Betr√§ge geworden. Spitzenreiter in Deutschland sind D√ºsseldorf und Berlin mit mehreren Euro pro Stunde. Tendenz steigend. Doch aus dem K√∂lner Rathaus hei√üt es an alle sich beschwerenden Autofahrer gerichtet, das Geld werde selbstverst√§ndlich zweckgebunden verwendet: f√ºr den Bau neuer Stra√üen. An denen neue Parkscheinautomaten stehen?.`,
            questions: [
              {
                id: "s2q1",
                type: "single",
                text: "Die ersten Parkuhren Europas standen",
                options: [
                  {id: "s2q1o1", text: "in der Schweiz und in Deutschland."},
                  {id: "s2q1o2", text: " in der Schweiz und in Schweden.‚Ä®"},
                  {id: "s2q1o3", text: "in Deutschland und in Schweden."}
                ],
                correctAnswer: "s2q1o2"
              },
              {
                id: "s2q2",
                type: "single", 
                text: "Fr√ºher wurden in Duisburg die Parkgeb√ºhren verwendet, um‚Ä®",
                options: [
                  {id: "s2q2o1", text: "Bed√ºrftige zu unterst√ºtzen"},
                  {id: "s2q2o2", text: "Dauerparker aus den Stadtzentren zu vertreiben."},
                  {id: "s2q2o3", text: "L√∂cher im st√§dtischen Haushalt zu stopfen."}
                ],
                correctAnswer: "s2q2o1"
              },
              {
                id: "s2q3",
                type: "single",
                text: "Die ersten Parkuhren",
                options: [
                  {id: "s2q3o1", text: "funktionierten problemlos."},
                  {id: "s2q3o2", text: "gaben nur Groschen zur√ºck."},
                  {id: "s2q3o3", text: "konnten nur M√ºnzen annehmen."}
                ],
                correctAnswer: "s2q3o3"
              },
              {
                id: "s2q4",
                type: "single",
                text: "Die neuen Parkscheinautomaten",
                options: [
                  {id: "s2q4o1", text: "funktionieren nur bargeldlos."},
                  {id: "s2q4o2", text: "geben kein Wechselgeld zur√ºck."},
                  {id: "s2q4o3", text: "sind flexibel im Hinblick auf die Art der Bezahlung."}
                ],
                correctAnswer: "s2q4o3"
              },
              {
                id: "s2q5", 
                type: "single",
                text: "In Berlin und in D√ºsseldorf",
                options: [
                  {id: "s2q5o1", text: "flie√üen die Parkgeb√ºhren nur in den Stra√üenbau."},
                  {id: "s2q5o2", text: "nimmt die Zahl der Parkscheinautomaten zu."},
                  {id: "s2q5o3", text: "werden die h√∂chsten Parkgeb√ºhren verlangt."}
                ],
                correctAnswer: "s2q5o3"
              }
            ]
          },
          { 
            id: "s3", 
            title: "Leseverstehen, Teil 3", 
            points: 25,
            passageTitle: "Aufgabe: Lesen Sie die zehn Situationen (11-20) und die zw√∂lf Texte (A-L). Welcher Text passt zu welcher Situation? Sie k√∂nnen jeden Text nur einmal verwenden. ManchŸÖÿß passt kein Text. W√§hlen Sie dann 'x'.",
            passage: "",
            questions: [],
            texts: [
              {id: "A", text: "Auf unserer Homepage finden Sie nicht nur aktuelle Wetterberichte f√ºr Ihren Wohnort, sondern auch verl√§ssliche Vorhersagen f√ºr Ihre Region, f√ºr Europa und die ganze Welt. Wir geben laufend zeitnahe Unwetterwarnungen und st√ºndlich aktualisierte Daten zu Schneeh√∂hen und Wasserpegel. Allergiker und wetterf√ºhlige Menschen bekommen bei uns gesundheitsbezogene Informationen zu Biowetter, Pollenflug oder Ozonwerten. √úber unsere Seite haben Sie Zugang zu einem dichten Netz von Webcams in ganz Deutschland und den Grenzregionen. Durch eine Mitgliedschaft bei WetAkt.com profitieren Sie von unseren zahlreichen Apps: >>mehr", correctAnswer: "13"},
              {id: "B", text: "Die beiden letzten Tage waren f√ºr die Winzer eine Katastrophe. Nachdem der Fr√ºhling √ºberdurchschnittlich warm gewesen war, entfalteten sich die Reben viel fr√ºher als sonst. Deshalb traf der j√ºngste K√§lteeinbruch die Bl√ºten und Knospen besonders stark. Im Norden und Osten Frankreichs, in Deutschland und in der Schweiz wurden Temperaturen bis zu minus 8 Grad gemessen. Selbst in Italien, vor allem in der Toskana, wurden Minusgrade verzeichnet. Der Frost hat in der Chianti-Region gro√üe Sch√§den angerichtet. Details zur Entsch√§digung f√ºr Frostsch√§den im Weinbau finden Sie hier.", correctAnswer: null},
              {id: "C", text: "Wir bauen seit vier Generationen Wein an und haben vor einigen Jahren auf √∂kologischen Weinbau umgestellt. Unser Weingut liegt in den sanften H√ºgeln Apuliens. F√ºr die Weinernte im Oktober suchen wir Helfer im Austausch gegen Verpflegung und Unterkunft. An f√ºnf Tagen pro Woche hilfst du bei allen T√§tigkeiten rund um den Wein. An deinen freien Tagen kannst du die wundersch√∂ne Gegend erkunden. Du wohnst in einem eigenen Zimmer und hast auf Wunsch Familienanschluss. Neben Italienisch sprechen wir auch Deutsch und Englisch. Kontaktformular", correctAnswer: "16"},
              {id: "D", text: "23. November: Vortrag Zeinab Schmidt-Hussain, Dominikanerhaus, Stadtplatz 18.‚Ä®Die Klimaforscherin und Meteorologin Zeinab Schmidt-Hussain ist seit Anfang des Jahres die neue Leiterin des Silberberg-Observatoriums. Die junge Wissenschaftlerin hat bereits viel beachtete Forschungsergebnisse f√ºr unterschiedliche Bereiche der Klima- und Wetterkunde vorgelegt. In ihrem Vortrag spricht sie √ºber ihre Zeit an einer Forschungsstation am S√ºdpol, in der sie zwei Jahre verbracht hat. Sie zeigt au√üergew√∂hnliche Aufnahmen und berichtet dabei vom Alltag und den Arbeitsbedingungen bei Temperaturen, die auch im Sommer nicht √ºber minus 40 Grad Celsius steigen. Beginn ist um 20:00 Uhr.", correctAnswer: "17"},
              {id: "E", text: "Sie sind auf der Suche nach dem besten Preis-Leistungs-Verh√§ltnis? Dann sind Sie in unserem Online-Shop genau richtig! Bei uns finden Sie Sonderpreise, ohne auf Qualit√§t verzichten zu m√ºssen. Von Moselweinen bis zu franz√∂sischem Rotwein wir halten das ganze Jahr √ºber eine gro√üe Auswahl an attraktiven Sonderangeboten bereit. Wie das m√∂glich ist? Wir kaufen gro√üe Mengen g√ºnstig ein und geben den niedrigen Preis an Sie weiter. Bei manchen Sorten sparen Sie bis zu 40 Prozent im Vergleich zum Preis im Gesch√§ft. weiterlesen", correctAnswer: "19"},
              {id: "F", text: "Die afrikanische Schlafkrankheit wird durch die Tsetsefliege auf Tiere und Menschen √ºbertragen. Die Krankheit, die mit Nervensch√§digungen und hohem Fieber verbunden ist, kann zum Tod f√ºhren. Ein Forscherteam zeigte nun, wie sich die Schlafkrankheit durch den Klimawandel weiter ausdehnen k√∂nnte. Diese Wissenschaftler gingen davon aus, dass sich die Erde in den n√§chsten Jahrzehnten um mehr als f√ºnf Grad erw√§rmen wird. Damit k√∂nnte die Tsetsefliege in Gebiete vordringen, die bisher zu kalt waren. Hier geht es zu dem Artikel.", correctAnswer: "20"},
              {id: "G", text: "Mit Temperaturen von bis zu minus 20 Grad und starken Sturmb√∂en herrschen in weiten Teilen Europas extreme Winterbedingungen. Unter dem Einfluss des heftigen Windes wurden in den letzten Tagen Fahrbahnen zugeweht, und stellenweise t√ºrmt sich der Schnee meterhoch. Autos blieben liegen, und vielerorts mussten die Rettungskr√§fte ausr√ºcken, um Menschen aus ihren Fahrzeugen zu befreien. Br√ºcken und Stra√üen mussten komplett gesperrt, der F√§hrenverkehr zu den Inseln eingestellt werden. In manchen Gegenden ist die Stromversorgung vollst√§ndig zusammengebrochen. Es scheint wie ein Wunder, dass unter diesen Bedingungen noch keine Opfer zu beklagen sind.", correctAnswer: null},
              {id: "H", text: "F√ºr Liebhaber franz√∂sischer Weine, die es individuell m√∂gen: Wir planen und organisieren f√ºr Sie ma√ügeschneiderte Urlaubsreisen in die bedeutendsten Weinbaugebiete Frankreichs, zum Beispiel nach Burgund, Bordeaux oder in die Champagne. Zu unseren Partner betrieben geh√∂ren nicht nur gro√üe Namen, sondern auch kleinere Winzer. Unsere Unterkunftsm√∂glichkeiten reichen von einfachen G√§steh√§usern in kleinen Weind√∂rfern bis zum luxuri√∂sen 5-Sterne-Hotel. Besichtigen Sieber√ºhmte Weing√ºter, erfahren Sie Interessantes rund um den Weinbau verkosten Sie die besten Weine und kaufen Sie Ihren Lieblingswein direkt vom Produzenten. Zu den Reisezielen", correctAnswer: "14"},
              {id: "I", text: "Das St√§dtische Museum beherbergt auch eine bedeutende Insektensammlung. Der Hobby-Insektenforscher R√ºdiger Wildhaber hat sie seiner Heimatstadt vermacht. In den Schauk√§sten und auf vergr√∂√üerten Fotos k√∂nnen die Besucher die unglaubliche Formen- und Farbenvielfalt der Insekten bewundern. Bei den J√ºngsten besonders beliebt sind die beiden √ºbergro√üen Modelle einer Biene und eines Marienk√§fers. In kindgerechten Vortr√§gen erz√§hlen unsere Mitarbeiterinnen und Mitarbeiter t√§glich von 15:00 bis 17:00 Uhr Wissenswertes √ºber die spannende Welt der Insekten, die artenreichste Klasse der Tiere. Themen und Termine finden Sie hier.", correctAnswer: "18"},
              {id: "J", text: "Der Sturm deckt das Dach Ihres Wohnhauses ab, nach den heftigen Regenf√§llen steht das Wasser in Ihrem Keller, oder die Schneelawine von Ihrem Dach verletzt Passanten: Unwettersch√§den k√∂nnen sehr teuer werden. Wir helfen Ihnen, sich so gut wie m√∂glich dagegen zu sch√ºtzen. Erfahren Sie hier, welche Versicherungen wir Ihnen anbieten. Das Wetter k√∂nnen Sie nicht √§ndern, aber Sie k√∂nnen dazu beitragen, Sch√§den zu vermeiden. Hier lesen Sie, wie Sie Unwettersch√§den vorbeugen k√∂nnen. Was tun, wenn doch ein Schaden auftritt? Das Vorgehen im Schadensfall erkl√§ren wir hier.", correctAnswer: "12"},
              {id: "K", text: "Weinverkostung - am 15. November, von 15.00 bis 19.00 Uhr, laden wir Genie√üer, Weinkenner und Fachleute zu unserer diesj√§hrigen Weinverkostung. Wir freuen uns besonders, unseren Besucherinnen und Besuchern einen Riesling vorzustellen, der bei zwei internationalen Wettbewerben ausgezeichnet wurde. Auf unserem Weingut in dem alten Schloss an der Mosel erwarten Sie neben der Verkostung auch attraktive Sonderangebote, die ausschlie√ülich f√ºr Besucherinnen und Besucher am Tag der offenen T√ºr reserviert sind. Weinverkostungen bieten wir auf Wunsch auch an anderen Tagen an. F√ºr Gruppen ab 20 Personen, 30 bis 45 Minuten.", correctAnswer: "15"},
              {id: "L", text: "Insektenwelten - der neue Insektenf√ºhrer - in keiner anderen Tiergruppe gibt es so viele Arten wie bei den Insekten. In rund 1500 Eintr√§gen gibt dieses neue Bestimmungsbuch eine umfassende √úbersicht √ºber die Vielfalt der Insekten, die in Europa anzutreffen sind. Es umfasst Fotos und detaillierte Zeichnungen in Farbe, die die charakteristischen Merkmale der einzelnen Arten hervorheben. Eine F√ºlle von popul√§rwissenschaftlichen Informationen im handlichen Taschenbuchformat - damit ist dieser F√ºhrer ein Muss f√ºr jeden Insektenliebhaber. Blick ins Buch. Taschenbuch, 395 Seiten, 32,80 EUR. Kaufen.", correctAnswer: "11"}
            ],
            situations: [
              {id: "11", text: "Ein Nachbar sucht ein illustriertes Buch, um Insektenarten erkennen zu k√∂nnen."},
              {id: "12", text: "Ein Sturm hat Ihr Auto besch√§digt. Sie m√∂chten wissen, was Sie nun machen sollen."},
              {id: "13", text: "Eine Bekannte f√§hrt in Urlaub und m√∂chte wissen, wie das Wetter in Italien ist."},
              {id: "14", text: "Freunde von Ihnen m√∂chten auf einer Reise im Ausland an Weinproben teilnehmen."},
              {id: "15", text: "Ihr Sohn m√∂chte eine Weinbauschule besuchen."},
              {id: "16", text: "Ihre Freundin interessiert sich f√ºr Bio-Weine und m√∂chte Reisen und Arbeiten verbinden."},
              {id: "17", text: "Sie m√∂chten gerne mehr √ºber die Lebensbedingungen bei extremer K√§lte erfahren."},
              {id: "18", text: "Sie planen f√ºr den Kindergeburtstag Ihrer Tochter einen lehrreichen Nachmittag."},
              {id: "19", text: "Sie sollen im Internet g√ºnstigen Wein f√ºr ein Familienfest bestellen."},
              {id: "20", text: "Sie suchen Informationen √ºber den Klimawandel."}
            ]
          },
          { 
            id: "s4", 
            title: "Sprachbausteine, Teil 1", 
            points: 15,
            passageTitle: "Aufgabe: Erg√§nzen Sie den Text. W√§hlen Sie f√ºr jede L√ºcke das passende Wort.",
            passage: "",
            questions: [],
            fillBlanks: [
              {
               id: "21",
               options: ["mit", "√ºber", "wegen"],
               correctAnswer: "√ºber"
           },
              {
              id: "22",
              options: ["au√üerdem", "sonst", "weiterhin"],
              correctAnswer: "au√üerdem"
              },
              {
              id: "23",
              options: ["fahren", "kommen", "nehmen"],
              correctAnswer: "nehmen"
              },
{
id: "24",
options: ["da", "darum", "deshalb"],
correctAnswer: "da"
},
{
id: "25",
options: ["dadurch", "damit", "davon"],
correctAnswer: "davon"
},
{
id: "26",
options: ["besprochen", "gesprochen", "versprochen"],
correctAnswer: "gesprochen"
},
{
id: "27",
options: ["als", "dass", "wenn"],
correctAnswer: "dass"
},
{
id: "28",
options: ["euch", "sich", "uns"],
correctAnswer: "sich"
},
{
id: "29",
options: ["das", "der", "die"],
correctAnswer: "die"
},
{
id: "30",
options: ["bestenfalls", "jedenfalls", "keinesfalls"],
correctAnswer: "jedenfalls"
}
],
fillText: `Lieber Igor, 
vielen Dank f√ºr deine Nachricht, ________ √ºber ich mich sehr gefreut habe. Es ist echt eine tolle Idee, im Sommer gemeinsam zu verreisen! Aber m√∂chtest du wirklich mit dem Auto fahren? Ich w√ºrde lieber die Bahn nehmen, denn das ist umweltfreundlicher und ________ au√üerdem noch billiger. Momentan bin ich n√§mlich mal wieder etwas knapp bei Kasse. Wir k√∂nnten doch eine Interrail-Tour machen. Mit einem Global Pass k√∂nnen wir in 30 europ√§ischen L√§ndern Zug ________ nehmen, und zwar wann und wohin auch immer - allerdings nicht bei uns in Deutschland. Hier m√ºssen wir extra zahlen. Aber wir haben es ja von mir aus nicht allzu weit bis zur Grenze. ________ da wir noch keine 26 Jahre alt sind, k√∂nnen wir den Pass ausgesprochen g√ºnstig bekommen. Der Preis h√§ngt ________ davon ab, wie lange wir unterwegs sein wollen. Wenn du lieber nur ein einziges Land bereisen m√∂chtest, schlage ich vor, nach Frankreich zu fahren. Dann n√§mlich w√ºrden wir f√ºr ein Interrail-Ticket sogar noch weniger zahlen. Ich habe auch schon mit meiner Tante in Marseille ________ gesprochen und sie hat gleich vorgeschlagen, ________ dass wir einige Tage bei ihr verbringen. Meine Cousins J√©r√¥me und Matthieu, die in Paris studieren, haben Semesterferien und werden auch dort sein. Die beiden w√ºrden ________ sich freuen, mit uns um die H√§user zu ziehen, und k√∂nnten uns sicherlich die angesagtesten Clubs der Stadt zeigen. Wegen ________ der Sprachkenntnisse brauchst du dir nicht den Kopf zu zerbrechen, denn die beiden sprechen ziemlich gut Deutsch. Was h√§ltst du davon? Hast du noch andere Vorschl√§ge? Ich freue mich ________ jedenfalls schon sehr auf unsere gemeinsame Reise. 
Bis bald,
 Thomas`
          },
          { 
            id: "s5", 
            title: "Sprachbausteine, Teil 2", 
            points: 15,
            passageTitle: "Aufgabe: Lesen Sie den Text und entscheiden Sie, welches Wort in welche L√ºcke passt. Sie k√∂nnen jedes Wort nur einmal verwenden. Nicht alle W√∂rter passen in den Text.",
            passage: "",
            questions: [],
            fillBlanks2: [
              {
id: "31",
options: ["Flut", "abgrenzen", "als", "diesen", "aber", "Korrekt", "meisten", "recht", "reisend", "somit", "stellt", "unlogische", "unterscheiden", "verschieden", "zwar"],
correctAnswer: "Flut"
},
{
id: "32",
options: ["recht", "abgrenzen", "diesen"],
correctAnswer: "recht"
},
{
id: "33",
options: ["aber", "verschieden", "zwar"],
correctAnswer: "aber"
},
{
id: "34",
options: ["stellt", "somit", "unlogische"],
correctAnswer: "stellt"
},
{
id: "35",
options: ["Diesen", "Korrekt", "zwar"],
correctAnswer: "Diesen"
},
{
id: "36",
options: ["meisten", "verschieden", "unterscheiden"],
correctAnswer: "meisten"
},
{
id: "37",
options: ["Korrekt", "unlogische", "somit"],
correctAnswer: "Korrekt"
},
{
id: "38",
options: ["unlogische", "unterscheiden", "verschieden"],
correctAnswer: "unlogische"
},
{
id: "39",
options: ["unterscheiden", "somit", "verschieden"],
correctAnswer: "unterscheiden"
},
{
id: "40",
options: ["somit", "verschieden", "abgrenzen"],
correctAnswer: "somit"
}
            ],
            fillText2: `Manipulierte Bilder?

'Im Internet, in sozialen Netzwerken und der Werbung werden wir mit einer ________ Flut von Fotos konfrontiert. Klar ist: Viele von ihnen sind keine wirklichen Originale, Bildbearbeitungsprogramme machen es sogar f√ºr Laien ________ recht einfach, Fotos zu ver√§ndern. Meist sind die Manipulationen harmlos, ________ aber die M√∂glichkeiten der Bildbearbeitung lassen sich nat√ºrlich auch f√ºr Betr√ºgereien oder Meinungsmache missbrauchen. In diesem Zusammenhang ________ stellt sich die Frage, inwieweit Betrachtern solche Manipulationen auffallen. K√∂nnen Sie erkennen, dass an einem Bild etwas merkw√ºrdig ist, oder sogar die manipulierte Stelle finden? ________ Diesen Fragen sind nun Forscher der University of Warwick nachgegangen. Sie entwickelten dazu ein Online-Testsystem, bei dem die Teilnehmer den manipulierten Bereich auf Fotos erkennen sollten. Die Auswertungen ergaben: Die ________ meisten Teilnehmer waren nur eher zuf√§llig in der Lage, ein manipuliertes Bild zu identifizieren. Oft hatten sie das vage Gef√ºhl, dass mit einem der Bilder etwas nicht stimmt. Nur in 45 Prozent der F√§lle konnten sie tats√§chlich ________ Korrekt bestimmen, wo das Bild ver√§ndert worden war. Selbst ein falscher Schattenwurf oder andere ________ unlogische Abweichungen wurden nicht besser erkannt als nachvollziehbare Manipulationen wie beispielsweise k√ºnstliche Farbver√§nderungen. Bilder haben einen starken Einfluss auf unsere Erinnerungen, so die Forscher. K√∂nnen Menschen also nicht zwischen echten und gef√§lschten Details auf Fotos ________ unterscheiden, so k√∂nnen manipulierte Bilder entscheidend beeinflussen, woran wir uns zu erinnern glauben. Die Ergebnisse dokumentierten ________ somit: Wir k√∂nnen recht leicht auf Fake-Fotos und damit auch auf ihre manipulierten Botschaften reinfallen. Aufbauend auf ihren Ergebnissen wollen die Forscher nun konkrete Ratschl√§ge erarbeiten, die dem Betrachter helfen sollen, Fotomanipulationen besser zu erkennen.`
          }
        ]
      };

      let state = { 
        sectionIndex: 0, 
        questionIndex: 0, 
        answers: {}, 
        marked: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      
      const topTiles = document.getElementById('topTiles-lesen');
      const passageTitleEl = document.getElementById('passageTitle-lesen');
      const passageContentEl = document.getElementById('passageContent-lesen');
      const sectionNameEl = document.getElementById('sectionName-lesen');
      const questionTitleEl = document.getElementById('questionTitle-lesen');
      const questionBodyEl = document.getElementById('questionBody-lesen');
      const headingsBankContainer = document.getElementById('headingsBankContainer-lesen');
      const timerEl = document.getElementById('timer-lesen');
      const statusText = document.getElementById('statusText-lesen');
      const resultBtn = document.getElementById('resultBtn-lesen');
      const resetBtn = document.getElementById('resetBtn-lesen');
      const resetSectionBtn = document.getElementById('resetSectionBtn-lesen');

      function startTimer() {
        if(state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(() => {
          if(state.remaining <= 0) {
            clearInterval(state.timerInterval);
            if (timerEl) timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer() {
        if(state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay() {
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        if (timerEl) {
          timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
        }
      }

      function resetCurrentSection() {
        const currentSection = exam.sections[state.sectionIndex];
        
        if (confirm(`M√∂chten Sie wirklich den Teil "${currentSection.title}" zur√ºcksetzen? Alle Antworten in diesem Teil werden gel√∂scht.`)) {
          if (currentSection.id === 's1') {
            currentSection.texts.forEach(text => {
              delete state.answers[text.id];
            });
          } else if (currentSection.id === 's2') {
            currentSection.questions.forEach(question => {
              delete state.answers[question.id];
            });
          } else if (currentSection.id === 's3') {
            currentSection.situations.forEach(situation => {
              delete state.answers[situation.id];
            });
          } else if (currentSection.id === 's4') {
            currentSection.fillBlanks.forEach(blank => {
              delete state.answers[blank.id];
            });
          } else if (currentSection.id === 's5') {
            currentSection.fillBlanks2.forEach(blank => {
              delete state.answers[blank.id];
            });
          }
          
          renderAll();
        }
      }

      function renderTopTiles() { 
        if (!topTiles) return;
        topTiles.innerHTML = ''; 
        exam.sections.forEach((sec, idx) => { 
          const div = document.createElement('div'); 
          div.className = 'tile' + (idx === state.sectionIndex ? ' active' : '') + (isSectionDone(sec) ? ' done' : ''); 
          div.innerHTML = `<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick = () => {
            state.sectionIndex = idx; 
            state.questionIndex = 0; 
            state.showResults = false; 
            renderAll();
          }; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section) {
        if(section.id === 's1') return section.texts.every(t => state.answers[t.id]);
        if(section.id === 's2') return section.questions.every(q => state.answers[q.id]);
        if(section.id === 's3') return section.situations.every(h => state.answers[h.id] || state.answers[h.id] === 'X');
        if(section.id === 's4') return section.fillBlanks.every(b => state.answers[b.id]);
        if(section.id === 's5') return section.fillBlanks2.every(b => state.answers[b.id]);
        return false;
      }

      function getHeadingTextById(id) {
        const section = exam.sections[state.sectionIndex];
        const heading = section.headings.find(h => h.id === id);
        return heading ? `${heading.id}) ${heading.text}` : '';
      }

      function selectOption(questionId, optionId) {
        state.answers[questionId] = optionId;
        try { localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); } catch(e) {}
        renderAll();
      }

      function markNoMatch(situationId) {
        Object.keys(state.answers).forEach(key => {
          if(state.answers[key] === situationId) {
            delete state.answers[key];
          }
        });
        
        state.answers[situationId] = 'X';
        try { localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); } catch(e) {}
        renderAll();
      }

      function selectSprachbausteine1(blankId, answer) {
        state.answers[blankId] = answer;
        renderAll();
      }

      function selectSprachbausteine2FromBank(word) {
        const slot = document.querySelector('.blank-slot.selected-sprach') || 
                     Array.from(document.querySelectorAll('.blank-slot')).find(s => {
                       const id = s.dataset.blankId;
                       return !state.answers[id];
                     });
        
        if (!slot) return;
        
        const blankId = slot.dataset.blankId;
        
        Object.keys(state.answers).forEach(k => {
          if(state.answers[k] === word) {
            delete state.answers[k];
          }
        });
        
        const prev = state.answers[blankId];
        if(prev) {
          const prevEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b => b.dataset.word === prev);
          if(prevEl) {
            prevEl.classList.remove('used');
            prevEl.setAttribute('draggable', 'true');
          }
        }
        
        const bankEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b => b.dataset.word === word);
        if(bankEl) {
          bankEl.classList.add('used');
          bankEl.setAttribute('draggable', 'false');
        }
        
        state.answers[blankId] = word;
        try { localStorage.setItem('lesenAnswers', JSON.stringify(state.answers)); } catch(e) {}
        
        document.querySelectorAll('.blank-slot').forEach(s => s.classList.remove('selected-sprach'));
        renderAll();
      }

      function renderAll() {
        if (!passageTitleEl || !passageContentEl || !sectionNameEl) return;
        
        renderTopTiles();
        const section = exam.sections[state.sectionIndex];
        sectionNameEl.textContent = section.title;
        passageTitleEl.textContent = section.passageTitle;
        
        if (resetSectionBtn) resetSectionBtn.style.display = 'block';
        
        if(state.showResults) {
          renderResults();
          return;
        }
        
        if(section.id === 's1') {
          renderPart1();
        } else if(section.id === 's2') {
          renderPart2();
        } else if(section.id === 's3') {
          renderPart3();
        } else if(section.id === 's4') {
          renderSprachbausteine1();
        } else if(section.id === 's5') {
          renderSprachbausteine2();
        }
      }

      function renderPart1() {
        const section = exam.sections[state.sectionIndex];
        
        let textsHTML = `<div class="instructions">Ziehen Sie die passenden √úberschriften auf die Texte. Sie k√∂nnen jede √úberschrift nur einmal verwenden.</div>`;
        
        section.texts.forEach((text, idx) => {
          const letter = String.fromCharCode(97 + idx);
          const selectedHeading = state.answers[text.id];
          
          textsHTML += `
            <div class="text-container">
              <div class="text-title">Text ${letter.toUpperCase()}</div>
              <div class="text-content">${text.content}</div>
              <div class="title-slot ${selectedHeading ? 'has-title' : ''}" data-text-id="${text.id}">
                ${selectedHeading ? getHeadingTextById(selectedHeading) : 'Ziehen Sie hier eine √úberschrift hin'}
              </div>
            </div>
          `;
        });
        
        passageContentEl.innerHTML = textsHTML;
        
        let headingsHTML = `<div class="headings-bank">`;
        section.headings.forEach(heading => {
          const isUsed = section.texts.some(text => state.answers[text.id] === heading.id);
          
          headingsHTML += `
            <div class="heading-item ${isUsed ? 'used' : ''}" draggable="${!isUsed}" data-heading-id="${heading.id}">
              ${heading.id}) ${heading.text}
            </div>
          `;
        });
        
        headingsHTML += `</div>`;
        
        if (headingsBankContainer) {
          headingsBankContainer.innerHTML = headingsHTML;
        }
        
        if (questionBodyEl) {
          questionBodyEl.innerHTML = '';
        }
        if (questionTitleEl) {
          questionTitleEl.textContent = '';
        }
        
        setupDragAndDrop();
      }

      function setupDragAndDrop() {
        const headingItems = document.querySelectorAll('.heading-item:not(.used)');
        const titleSlots = document.querySelectorAll('.title-slot');
        
        headingItems.forEach(item => {
          item.addEventListener('dragstart', (e) => {
            e.dataTransfer.setData('text/plain', e.target.dataset.headingId);
          });
        });
        
        titleSlots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.style.background = '#e8f4ff';
          });
          
          slot.addEventListener('dragleave', (e) => {
            slot.style.background = slot.classList.contains('has-title') ? '#e8fbe9' : '#f8fbff';
          });
          
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            const headingId = e.dataTransfer.getData('text/plain');
            const textId = slot.dataset.textId;
            
            Object.keys(state.answers).forEach(key => {
              if(state.answers[key] === headingId) {
                delete state.answers[key];
              }
            });
            
            state.answers[textId] = headingId;
            renderAll();
          });
        });
      }

      function renderPart2() {
        const section = exam.sections[state.sectionIndex];
        
        passageContentEl.innerHTML = `<div class="passage">${section.passage}</div>`;
        
        let questionsHTML = `<div class="all-questions">`;
        
        section.questions.forEach((question, idx) => {
          const questionNumber = idx + 1;
          const userAnswer = state.answers[question.id];
          
          questionsHTML += `
            <div class="question-block">
              <div class="question-text">${questionNumber}. ${question.text}</div>
              <div class="options">
                ${question.options.map(opt => `
                  <div class="option ${userAnswer === opt.id ? 'selected' : ''}" 
                       onclick="window.lesenApp.selectOption('${question.id}', '${opt.id}')">
                    <div class="radio"></div>
                    <div>${opt.text}</div>
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        });
        
        questionsHTML += `</div>`;
        
        questionBodyEl.innerHTML = questionsHTML;
        questionTitleEl.textContent = '';
        if (headingsBankContainer) headingsBankContainer.innerHTML = '';
      }

      function renderPart3() {
        const section = exam.sections[state.sectionIndex];
        
        let textsHTML = `
          <div class="instructions">Ziehen Sie die passenden Situationen auf die Texte. Sie k√∂nnen jede Situation nur einmal verwenden. Manchmal passt keine Situation.</div>
          <div class="texts-list">
            <h3>Texte (A-L)</h3>
        `;
        
        section.texts.forEach(text => {
          const userAnswer = Object.keys(state.answers).find(key => state.answers[key] === text.id);
          const selectedSituation = userAnswer ? section.situations.find(h => h.id === userAnswer) : null;
          
          textsHTML += `
            <div class="text-item" data-text-id="${text.id}">
              <div class="text-letter">${text.id})</div>
              <div class="text-content">${text.text}</div>
              <div class="title-slot ${userAnswer ? 'has-title' : ''} ${userAnswer === 'X' ? 'has-x' : ''}" data-text-id="${text.id}">
                ${selectedSituation ? selectedSituation.text : (userAnswer === 'X' ? 'X - Keine passende Situation' : 'Ziehen Sie hier eine Situation hin')}
              </div>
            </div>
          `;
        });
        
        textsHTML += `</div>`;
        
        passageContentEl.innerHTML = textsHTML;
        
        let situationsHTML = `
          <div class="situations-list">
            <h3>Situationen (11-20)</h3>
        `;
        
        section.situations.forEach((situation, idx) => {
          const situationNumber = parseInt(situation.id);
          const isUsed = state.answers[situation.id];
          const isX = state.answers[situation.id] === 'X';
          
          situationsHTML += `
            <div class="situation-item ${isUsed ? 'used' : ''}" draggable="${!isUsed}" data-situation-id="${situation.id}">
              <div class="situation-number">${situationNumber}.</div>
              <div class="situation-text">${situation.text}</div>
              ${!isUsed ? `<button class="exam-btn no-match ${isX ? 'selected' : ''}" onclick="window.lesenApp.markNoMatch('${situation.id}')">X - Kein passender Text</button>` : ''}
            </div>
          `;
        });
        
        situationsHTML += `</div>`;
        
        questionBodyEl.innerHTML = situationsHTML;
        questionTitleEl.textContent = '';
        if (headingsBankContainer) headingsBankContainer.innerHTML = '';
        
        setupPart3DragAndDrop();
      }

      function setupPart3DragAndDrop() {
        const situationItems = document.querySelectorAll('.situation-item:not(.used)');
        const textSlots = document.querySelectorAll('.text-item .title-slot');
        
        situationItems.forEach(item => {
          item.addEventListener('dragstart', (e) => {
            e.dataTransfer.setData('text/plain', e.target.dataset.situationId);
          });
        });
        
        textSlots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.style.background = '#e8f4ff';
          });
          
          slot.addEventListener('dragleave', (e) => {
            const hasTitle = slot.classList.contains('has-title');
            const hasX = slot.classList.contains('has-x');
            slot.style.background = hasTitle ? '#e8fbe9' : (hasX ? '#f8d7da' : '#f8fbff');
          });
          
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            const situationId = e.dataTransfer.getData('text/plain');
            const textId = slot.dataset.textId;
            
            Object.keys(state.answers).forEach(key => {
              if(state.answers[key] === situationId) {
                delete state.answers[key];
              }
            });
            
            state.answers[situationId] = textId;
            renderAll();
          });
        });
      }

      function renderSprachbausteine1() {
        const section = exam.sections[state.sectionIndex];
        
        let textWithBlanks = section.fillText;
        
        const blankPlaceholders = [];
        section.fillBlanks.forEach(blank => {
          blankPlaceholders.push(`BLANK_${blank.id}`);
        });
        
        let tempText = textWithBlanks;
        blankPlaceholders.forEach((placeholder, index) => {
          tempText = tempText.replace('________', placeholder);
        });
        
        section.fillBlanks.forEach(blank => {
          const userAnswer = state.answers[blank.id];
          const displayText = userAnswer ? userAnswer : '________';
          tempText = tempText.replace(`BLANK_${blank.id}`, `<span class="blank-word ${userAnswer ? 'has-answer' : ''}" data-blank-id="${blank.id}">${displayText}</span>`);
        });
        
        passageContentEl.innerHTML = `
          <div class="instructions">Klicken Sie auf jede L√ºcke und w√§hlen Sie das passende Wort aus. Sie k√∂nnen die L√ºcken in beliebiger Reihenfolge ausf√ºllen.</div>
          <div class="fill-blank-container">${tempText}</div>
        `;
        
        document.querySelectorAll('.blank-word').forEach(blank => {
          blank.addEventListener('click', (e) => {
            showOptionsPopup(e.target);
          });
        });
        
        let optionsHTML = `<div class="horizontal-options" style="gap: 8px;">`;
        
        section.fillBlanks.forEach(blank => {
          const userAnswer = state.answers[blank.id];
          
          optionsHTML += `
            <div class="option-row" style="padding: 8px; margin-bottom: 5px;">
              <div class="option-number">${blank.id}</div>
              <div class="option-buttons">
                ${blank.options.map(opt => `
                  <div class="option-btn ${userAnswer === opt ? 'selected' : ''}" 
                       onclick="window.lesenApp.selectSprachbausteine1('${blank.id}', '${opt}')" 
                       style="padding: 6px 12px; font-size: 12px;">
                    ${opt}
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        });
        
        optionsHTML += `</div>`;
        
        questionBodyEl.innerHTML = optionsHTML;
        questionTitleEl.textContent = '';
        if (headingsBankContainer) headingsBankContainer.innerHTML = '';
      }

      function showOptionsPopup(blankElement) {
        const existingPopup = document.querySelector('.options-popup');
        if(existingPopup) {
          existingPopup.remove();
        }
        
        const blankId = blankElement.getAttribute('data-blank-id');
        const section = exam.sections.find(s => s.id === 's4');
        const blank = section.fillBlanks.find(b => b.id === blankId);
        
        if(!blank) return;
        
        const popup = document.createElement('div');
        popup.className = 'options-popup';
        
        blank.options.forEach(opt => {
          const optionItem = document.createElement('div');
          optionItem.className = 'option-item';
          optionItem.textContent = opt;
          optionItem.onclick = () => {
            selectSprachbausteine1(blankId, opt);
            popup.remove();
          };
          popup.appendChild(optionItem);
        });
        
        blankElement.appendChild(popup);
      }

      function renderSprachbausteine2() {
        const section = exam.sections[state.sectionIndex];
        
        let textWithPlaceholders = section.fillText2;
        const placeholders = [];
        
        section.fillBlanks2.forEach(blank => {
          const ph = `BLANK_${blank.id}`;
          placeholders.push({id: blank.id, ph});
          textWithPlaceholders = textWithPlaceholders.replace('________', ph);
        });

        placeholders.forEach(item => {
          const userAnswer = state.answers[item.id];
          const displayText = userAnswer ? userAnswer : '________';
          const span = `<span class="blank-slot ${userAnswer ? 'has-answer' : ''}" data-blank-id="${item.id}">${displayText}</span>`;
          textWithPlaceholders = textWithPlaceholders.replace(item.ph, span);
        });

        passageContentEl.innerHTML = `
          <div class="instructions">Klicken Sie auf jede L√ºcke und w√§hlen Sie das passende Wort aus. Sie k√∂nnen jedes Wort nur einmal verwenden.</div>
          <div class="fill-blank-container">${textWithPlaceholders}</div>
        `;

        document.querySelectorAll('.blank-slot').forEach(slot => {
          slot.addEventListener('click', (e) => {
            showSprachbausteine2Options(slot);
          });
        });

        let wordBankHTML = `<div class="word-bank-vertical" style="gap: 8px;">`;
        const usedWords = Object.values(state.answers);
        const bank = section.fillBlanks2[0] ? section.fillBlanks2[0].options : [];
        
        bank.forEach(word => {
          const isUsed = usedWords.includes(word);
          wordBankHTML += `
            <div class="bank-word-vertical ${isUsed ? 'used' : ''}" 
                 draggable="${!isUsed}" 
                 data-word="${word}"
                 onclick="window.lesenApp.selectSprachbausteine2FromBank('${word}')">
              ${word}
            </div>
          `;
        });
        wordBankHTML += `</div>`;
        
        questionBodyEl.innerHTML = wordBankHTML;
        questionTitleEl.textContent = '';
        if (headingsBankContainer) headingsBankContainer.innerHTML = '';

        setupSprachbausteine2DragAndDrop();
      }

      function setupSprachbausteine2DragAndDrop() {
        const bankWords = Array.from(document.querySelectorAll('.bank-word-vertical'));
        
        bankWords.forEach(el => {
          const word = el.dataset.word;
          
          if(!el.classList.contains('used')) {
            el.setAttribute('draggable', 'true');
          } else {
            el.setAttribute('draggable', 'false');
          }
          
          el.removeEventListener('dragstart', el._dstart);
          el._dstart = (e) => {
            e.dataTransfer.setData('text/plain', word);
          };
          el.addEventListener('dragstart', el._dstart);
        });

        const slots = Array.from(document.querySelectorAll('.blank-slot'));
        slots.forEach(slot => {
          slot.addEventListener('dragover', (e) => {
            e.preventDefault();
            slot.classList.add('drag-over');
          });
          
          slot.addEventListener('dragleave', (e) => {
            slot.classList.remove('drag-over');
          });
          
          slot.addEventListener('drop', (e) => {
            e.preventDefault();
            slot.classList.remove('drag-over');
            const word = e.dataTransfer.getData('text/plain');
            if(!word) return;
            
            const blankId = slot.dataset.blankId;
            if(!blankId) return;
            
            Object.keys(state.answers).forEach(k => {
              if(state.answers[k] === word) {
                delete state.answers[k];
              }
            });
            
            const prev = state.answers[blankId];
            if(prev) {
              const prevEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b => b.dataset.word === prev);
              if(prevEl) {
                prevEl.classList.remove('used');
                prevEl.setAttribute('draggable', 'true');
              }
            }
            
            const bankEl = Array.from(document.querySelectorAll('.bank-word-vertical')).find(b => b.dataset.word === word);
            if(bankEl) {
              bankEl.classList.add('used');
              bankEl.setAttribute('draggable', 'false');
            }
            
            state.answers[blankId] = word;
            renderAll();
          });
        });
      }

      function showSprachbausteine2Options(slot) {
        document.querySelectorAll('.blank-slot').forEach(s => s.classList.remove('selected-sprach'));
        slot.classList.add('selected-sprach');
      }

      function renderResults() {
        let resultsHTML = `<h2>Ergebnisse</h2>`;
        let totalCorrect = 0;
        let totalQuestions = 0;
        
        exam.sections.forEach(section => {
          resultsHTML += `<div class="result-item"><h3>${section.title}</h3>`;
          
          if(section.id === 's1') {
            section.texts.forEach(text => {
              totalQuestions++;
              const userAnswer = state.answers[text.id];
              const isCorrect = userAnswer === text.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>Text ${text.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's2') {
            section.questions.forEach(question => {
              totalQuestions++;
              const userAnswer = state.answers[question.id];
              const isCorrect = userAnswer === question.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>${question.text}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's3') {
            section.situations.forEach(situation => {
              totalQuestions++;
              const userAnswer = state.answers[situation.id];
              const correctText = section.texts.find(t => t.correctAnswer === situation.id);
              const isCorrect = userAnswer === (correctText ? correctText.id : null);
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>Situation ${situation.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's4') {
            section.fillBlanks.forEach(blank => {
              totalQuestions++;
              const userAnswer = state.answers[blank.id];
              const isCorrect = userAnswer === blank.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>L√ºcke ${blank.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          } else if(section.id === 's5') {
            section.fillBlanks2.forEach(blank => {
              totalQuestions++;
              const userAnswer = state.answers[blank.id];
              const isCorrect = userAnswer === blank.correctAnswer;
              if(isCorrect) totalCorrect++;
              
              resultsHTML += `
                <div>L√ºcke ${blank.id}: ${userAnswer || 'Nicht beantwortet'} 
                ${userAnswer ? `<span class="${isCorrect ? 'result-correct' : 'result-incorrect'}">${isCorrect ? '‚úì' : '‚úó'}</span>` : ''}
                </div>
              `;
            });
          }
          
          resultsHTML += `</div>`;
        });
        
        const percentage = totalQuestions > 0 ? Math.round((totalCorrect / totalQuestions) * 100) : 0;
        resultsHTML += `<div class="result-item"><h3>Gesamtergebnis: ${totalCorrect}/${totalQuestions} (${percentage}%)</h3></div>`;
        
        passageContentEl.innerHTML = resultsHTML;
        if (questionBodyEl) questionBodyEl.innerHTML = '';
        if (sectionNameEl) sectionNameEl.textContent = 'Ergebnisse';
        if (questionTitleEl) questionTitleEl.textContent = '';
      }

      // Event Listeners
      const prevBtn = document.getElementById('prevBtn-lesen');
      const nextBtn = document.getElementById('nextBtn-lesen-footer');
      const nextBtnMain = document.getElementById('nextBtn-lesen');
      const saveBtn = document.getElementById('saveBtn-lesen');
      const submitBtn = document.getElementById('submitBtn-lesen');
      
      if (prevBtn) {
        prevBtn.addEventListener('click', () => {
          if(state.sectionIndex > 0) {
            state.sectionIndex--;
            state.questionIndex = 0;
            renderAll();
          }
        });
      }

      if (nextBtn) {
        nextBtn.addEventListener('click', () => {
          if(state.sectionIndex < exam.sections.length - 1) {
            state.sectionIndex++;
            state.questionIndex = 0;
            renderAll();
          }
        });
      }

      if (resultBtn) {
        resultBtn.addEventListener('click', () => {
          state.showResults = !state.showResults;
          renderAll();
        });
      }

      if (resetBtn) {
        resetBtn.addEventListener('click', () => {
          if(confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂scht.')) {
            state.answers = {};
            state.marked = {};
            state.showResults = false;
            resetTimer();
            renderAll();
          }
        });
      }

      if (resetSectionBtn) {
        resetSectionBtn.addEventListener('click', resetCurrentSection);
      }

      if (saveBtn) {
        saveBtn.addEventListener('click', () => {
          statusText.textContent = 'Gespeichert';
          setTimeout(() => {
            if (statusText) statusText.textContent = 'Nicht gespeichert';
          }, 2000);
        });
      }

      if (submitBtn) {
        submitBtn.addEventListener('click', () => {
          if(confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')) {
            state.showResults = true;
            renderAll();
          }
        });
      }

      if (nextBtnMain) {
        nextBtnMain.addEventListener('click', () => {
          showPage('hoeren-page');
        });
      }

      // Initialize
      updateTimerDisplay();
      renderAll();
      startTimer();
      
      // Expose functions
      window._lesenState = state;
      window.lesenApp = {
        selectOption: selectOption,
        markNoMatch: markNoMatch,
        selectSprachbausteine1: selectSprachbausteine1,
        selectSprachbausteine2FromBank: selectSprachbausteine2FromBank
      };
    }

    // ===== H√ñREN PAGE FUNCTIONALITY =====
    function initHoerenPage() {
      const exam = {
        id: "exam-h√∂rverstehen",
        durationSec: 17 * 60,
        sections: [
          { 
            id: "h√∂rverstehen1", 
            title: "H√∂rverstehen, Teil 1", 
            points: 25,
            correctAnswers: { "41": "richtig", "42": "falsch", "43": "falsch", "44": "falsch", "45": "richtig" },
            questions: [
              { id: "41", text: "die Fluaggeselschaft DL fligt Z. B Rostok nicht mehr an." },
              { id: "42", text: "S√º√üwaren warden dieses Jahr angeboten, um K√§ufer Zur√ºckzugewinnen." },
              { id: "43", text: "Die Sonnenst√ºrme hatten keine negativen Auswirkungen." },
              { id: "44", text: "Einer der kandidaten Konnte die Mehrheit der Zuschauer fur sich gewinnen" },
              { id: "45", text: "Das Tiefdruckgebiet Helena Kann morgen im S√ºdWesten Deutschlands Verkehrsprobleme Verursachen" }
            ]
          },
          { 
            id: "h√∂rverstehen2", 
            title: "H√∂rverstehen, Teil 2", 
            points: 25,
            correctAnswers: { "46": "falsch", "47": "richtig", "48": "falsch", "49": "richtig", "50": "richtig", "51": "falsch", "52": "falsch", "53": "richtig", "54": "falsch", "55": "richtig" },
            questions: [
              { id: "46", text: "Markus ist schon w√§hrend des Studiums an eine amerikanische Universit√§t gegangen." },
              { id: "47", text: "Markus wollte in einem besonders erfolgreichen Team mitarbeiten." },
              { id: "48", text: "Um eine Stelle in einer amerikanischen Forschergruppe zu bekommen, muss man viel Gl√ºck haben" },
              { id: "49", text: "Markus befindet sich zwischen Ausbildung und Beruf." },
              { id: "50", text: "Das Studium in Bonn hat Markus sehr gut auf den Auslandsaufenthalt vorbersitet." },
              { id: "51", text: "Markus hatte nach der Ankunft in den USA sehr viele Schwierigkeiten." },
              { id: "52", text: "Markus ist immer noch sehr nerv√∂s in der fremden Umgebung." },
              { id: "53", text: "Markus ist mit den Arbeitsbedingungen zufrieden." },
              { id: "54", text: "Markus bef√ºrwortet es nicht, dass sich Studenten in der USA fr√ºh auf ihre zuk√ºnftig Beruf festlegen m√ºssen." },
              { id: "55", text: "f√ºr Markus ist Vorteil, dass er in Deutschland die Referat und vortrag halten m√ºsste." }
            ]
          },
          { 
            id: "h√∂rverstehen3", 
            title: "H√∂rverstehen, Teil 3", 
            points: 25,
            correctAnswers: { "56": "richtig", "57": "falsch", "58": "falsch", "59": "falsch", "60": "richtig" },
            questions: [
              { id: "56", text: "Man kann am Tag des Ehrenamts probeweise mithelfen." },
              { id: "57", text: "Die Skateboard -Vof√ºrung f√§llt dieses mal aus." },
              { id: "58", text: "Vor passwort- programmen wird gewarnt." },
              { id: "59", text: "Es wird empfohlen, mit dem fahrrad zum Volkspark zu fahren." },
              { id: "60", text: "Wenn man das Training ausprobieren m√∂chte, muss man voher Bescheid sagen" }
            ]
          }
        ]
      };

      let state = { 
        sectionIndex: 0, 
        answers: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      
      const topTiles = document.getElementById('topTiles-hoeren');
      const contentContainer = document.getElementById('contentContainer-hoeren');
      const timerEl = document.getElementById('timer-hoeren');
      const statusText = document.getElementById('statusText-hoeren');

      function startTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(() => {
          if (state.remaining <= 0) {
            clearInterval(state.timerInterval);
            if (timerEl) timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay() {
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        if (timerEl) {
          timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
        }
      }

      function renderTopTiles() { 
        if (!topTiles) return;
        topTiles.innerHTML = ''; 
        exam.sections.forEach((sec, idx) => { 
          const div = document.createElement('div'); 
          div.className = 'tile' + (idx === state.sectionIndex ? ' active' : '') + (isSectionDone(sec) ? ' done' : ''); 
          div.innerHTML = `<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick = () => { 
            state.sectionIndex = idx; 
            state.showResults = false; 
            renderAll(); 
          }; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section) {
        const answers = state.answers[section.id];
        if (!answers) return false;
        return Object.keys(answers).length === section.questions.length;
      }

      function renderAll() {
        renderTopTiles();
        
        if (state.showResults) {
          renderResults();
          return;
        }
        
        renderListeningSection();
      }

      function renderListeningSection() {
        const section = exam.sections[state.sectionIndex];
        const currentAnswers = state.answers[section.id] || {};
        
        let contentHTML = `
          <div class="panel-title">${section.title}</div>
          <div class="instructions">
            Sie h√∂ren die Nachrichten. Entscheiden Sie beim H√∂ren, ob die Aussagen richtig oder falsch sind. 
            Sie h√∂ren die Nachrichten nur einmal. Sie haben jetzt 30 Sekunden, um die Aussagen zu lesen.
          </div>
          
          <div class="listening-task">
            <table class="true-false-table">
              <thead>
                <tr>
                  <th style="width: 10%">Nr.</th>
                  <th style="width: 60%">Aussage</th>
                  <th style="width: 30%">Ihre Antwort</th>
                </tr>
              </thead>
              <tbody>
        `;
        
        section.questions.forEach((question) => {
          const currentAnswer = currentAnswers[question.id] || '';
          contentHTML += `
            <tr>
              <td><strong>${question.id}</strong></td>
              <td class="question-text">${question.text}</td>
              <td>
                <div class="answer-options">
                  <label class="answer-option">
                    <input 
                      type="radio" 
                      name="q${section.id}_${question.id}" 
                      value="richtig" 
                      ${currentAnswer === 'richtig' ? 'checked' : ''}
                      onchange="window.hoerenApp.updateListeningAnswer('${section.id}', '${question.id}', this.value)"
                    >
                    Richtig
                  </label>
                  <label class="answer-option">
                    <input 
                      type="radio" 
                      name="q${section.id}_${question.id}" 
                      value="falsch" 
                      ${currentAnswer === 'falsch' ? 'checked' : ''}
                      onchange="window.hoerenApp.updateListeningAnswer('${section.id}', '${question.id}', this.value)"
                    >
                    Falsch
                  </label>
                </div>
              </td>
            </tr>
          `;
        });
        
        contentHTML += `
              </tbody>
            </table>
          </div>
        `;
        
        if (contentContainer) {
          contentContainer.innerHTML = contentHTML;
        }
      }

      function updateListeningAnswer(sectionId, questionId, answer) {
        if (!state.answers[sectionId]) {
          state.answers[sectionId] = {};
        }
        state.answers[sectionId][questionId] = answer;
        try { localStorage.setItem('hoerenAnswers', JSON.stringify(state.answers)); } catch(e) {}
        renderTopTiles();
      }

      function renderResults() {
        let resultsHTML = `<div class="panel-title">Ergebnisse - H√∂rverstehen</div>`;
        
        exam.sections.forEach(section => {
          const userAnswers = state.answers[section.id] || {};
          let correctCount = 0;
          
          resultsHTML += `
            <div class="listening-task">
              <h3>${section.title} (${section.points} Punkte)</h3>
              <table class="true-false-table">
                <thead>
                  <tr>
                    <th style="width: 10%">Nr.</th>
                    <th style="width: 50%">Aussage</th>
                    <th style="width: 15%">Ihre Antwort</th>
                    <th style="width: 15%">Richtige Antwort</th>
                    <th style="width: 10%">Punkte</th>
                  </tr>
                </thead>
                <tbody>
          `;
          
          section.questions.forEach((question) => {
            const userAnswer = userAnswers[question.id] || '-';
            const correctAnswer = section.correctAnswers[question.id];
            const gotCorrect = userAnswer === correctAnswer;
            const points = gotCorrect ? "1" : "0";
            
            if (gotCorrect) correctCount++;
            
            const rowClass = gotCorrect ? 'correct-answer' : 'incorrect-answer';
            
            resultsHTML += `
              <tr class="${rowClass}">
                <td><strong>${question.id}</strong></td>
                <td class="question-text">${question.text}</td>
                <td>${userAnswer}</td>
                <td>${correctAnswer}</td>
                <td><strong>${points}</strong></td>
              </tr>
            `;
          });
          
          const totalPoints = Math.round((correctCount / section.questions.length) * section.points);
          
          resultsHTML += `
                </tbody>
              </table>
              <div style="margin-top: 15px; padding: 15px; background: #e3f2fd; border-radius: 6px;">
                <strong>Erreichte Punkte: ${correctCount}/${section.questions.length} richtig = ${totalPoints}/${section.points} Punkten</strong>
              </div>
            </div>
          `;
        });
        
        if (contentContainer) {
          contentContainer.innerHTML = resultsHTML;
        }
      }

      // Event Listeners
      const prevBtn = document.getElementById('prevBtn-hoeren');
      const nextBtn = document.getElementById('nextBtn-hoeren-footer');
      const resultBtn = document.getElementById('resultBtn-hoeren');
      const resetBtn = document.getElementById('resetBtn-hoeren');
      const saveBtn = document.getElementById('saveBtn-hoeren');
      const submitBtn = document.getElementById('submitBtn-hoeren');
      const nextBtnMain = document.getElementById('nextBtn-hoeren');
      
      if (prevBtn) {
        prevBtn.addEventListener('click', () => {
          if (state.sectionIndex > 0) {
            state.sectionIndex--;
            state.showResults = false;
            renderAll();
          }
        });
      }

      if (nextBtn) {
        nextBtn.addEventListener('click', () => {
          if (state.sectionIndex < exam.sections.length - 1) {
            state.sectionIndex++;
            state.showResults = false;
            renderAll();
          }
        });
      }

      if (resultBtn) {
        resultBtn.addEventListener('click', () => {
          state.showResults = !state.showResults;
          renderAll();
        });
      }

      if (resetBtn) {
        resetBtn.addEventListener('click', () => {
          if (confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂scht.')) {
            state.answers = {};
            state.showResults = false;
            resetTimer();
            renderAll();
          }
        });
      }

      if (saveBtn) {
        saveBtn.addEventListener('click', () => {
          if (statusText) {
            statusText.textContent = 'Gespeichert';
            setTimeout(() => { 
              if (statusText) statusText.textContent = 'Nicht gespeichert'; 
            }, 2000);
          }
        });
      }

      if (submitBtn) {
        submitBtn.addEventListener('click', () => {
          if (confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')) {
            state.showResults = true;
            renderAll();
          }
        });
      }

      if (nextBtnMain) {
        nextBtnMain.addEventListener('click', () => {
          showPage('schreiben-page');
        });
      }

      // Initialize
      updateTimerDisplay();
      renderAll();
      startTimer();
      
      window._hoerenState = state;
      window.hoerenApp = {
        updateListeningAnswer: updateListeningAnswer
      };
    }

    // ===== SCHREIBEN PAGE FUNCTIONALITY =====
    function initSchreibenPage() {
      const exam = {
        id: "exam-002",
        durationSec: 30 * 60,
        sections: [
          { 
            id: "s1", 
            title: "Schreiben, Teil 1", 
            points: 45,
            passageTitle: "Aufgabe: Schreiben Sie eine E-Mail",
            passage: "",
            writingTask: {
              prompt: `Schluss mit Schwitzen und Kriechen beim Staubsaugen!

SuperClean-Staubsaugroboter ist Ihr neuer Helfer im Haus.

Darf ich mich vorstellen? Mein Name ist SuperClean-Staubsaugroboter. Ich bin Ihr neuer Staubsaugroboter. 
Sie haben schon lange nach einem Helfer im Haushalt gesucht? Sie m√∂chten nicht mehr selbst staubsaugen und 
trotzdem eine saubere Wohnung haben? Dann brauchen Sie meine Hilfe. W√§hrend Sie lesen oder kochen, 
bin ich f√ºr Sie in Ihrer Wohnung unterwegs. Ich sauge dort, wo Sie es nicht schaffen: unter den Betten, unter dem Sofa. 
Staubsaugen ist meine Passion.

SuperClean-Staubsaugroboter arbeitet, w√§hrend Sie sich vergn√ºgen. Am liebsten arbeite ich f√ºr Sie, wenn Sie nicht 
zu Hause sind ‚Äì dank App auch ganz einfach von unterwegs zu starten und zu bedienen.

Was kann Ihr neuer Helfer?
- Leistungsstark auf allen B√∂den
- Angenehm leise
- Sicheres Navigieren mit System
- Reinigt unter Betten, Sofas, Tischen und einfach √ºberall
- Geeignet auch f√ºr stark verschmutzte Fl√§chen
- Ob Tierhaare oder Haushaltsm√ºll ‚Äì von mir bleibt nichts verschont
- R√ºckerstattung des Kaufpreises, wenn Sie unzufrieden sind

Mein Preis: 499,90 Euro. 
Sie k√∂nnen mich direkt bei SuperClean-Staubsaugroboter GmbH bestellen.

SuperClean-Staubsaugroboter GmbH
Adenauerstra√üe 12
50600 K√∂ln`,
              requirements: [
                "Beschreiben Sie, was nicht zu Ihrer Zufriedenheit ausf√§llt.",
                "Erkl√§ren Sie, warum Sie sich genau f√ºr dieses Ger√§t entschieden hatten.",
                "Schreiben Sie, welche Sch√§den Ihnen durch dieses Ger√§t bereits entstanden sind.",
                "Legen Sie dar, was Sie nun vom Hersteller verlangen."
              ],
              wordCount: 0
            }
          }
        ]
      };

      let state = { 
        sectionIndex: 0, 
        answers: {}, 
        remaining: exam.durationSec,
        showResults: false,
        timerStarted: false,
        timerInterval: null
      };
      
      const topTiles = document.getElementById('topTiles-schreiben');
      const passageTitleEl = document.getElementById('passageTitle-schreiben');
      const passageContentEl = document.getElementById('passageContent-schreiben');
      const writingContainer = document.getElementById('writingContainer-schreiben');
      const timerEl = document.getElementById('timer-schreiben');
      const statusText = document.getElementById('statusText-schreiben');

      function startTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        
        state.timerStarted = true;
        state.timerInterval = setInterval(() => {
          if (state.remaining <= 0) {
            clearInterval(state.timerInterval);
            if (timerEl) timerEl.textContent = 'Zeit abgelaufen';
            return;
          }
          state.remaining--;
          updateTimerDisplay();
        }, 1000);
      }

      function resetTimer() {
        if (state.timerInterval) {
          clearInterval(state.timerInterval);
        }
        state.remaining = exam.durationSec;
        state.timerStarted = false;
        updateTimerDisplay();
        startTimer();
      }

      function updateTimerDisplay() {
        const min = Math.floor(state.remaining / 60);
        const sec = state.remaining % 60;
        if (timerEl) {
          timerEl.textContent = `Verbleibende Zeit: ${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
        }
      }

      function renderTopTiles() { 
        if (!topTiles) return;
        topTiles.innerHTML = ''; 
        exam.sections.forEach((sec, idx) => { 
          const div = document.createElement('div'); 
          div.className = 'tile' + (idx === state.sectionIndex ? ' active' : '') + (isSectionDone(sec) ? ' done' : ''); 
          div.innerHTML = `<div>${sec.title}</div><div class="points">${sec.points} P</div>`; 
          div.onclick = () => { 
            state.sectionIndex = idx; 
            state.showResults = false; 
            renderAll(); 
          }; 
          topTiles.appendChild(div); 
        }); 
      }

      function isSectionDone(section) {
        return state.answers[section.id] && state.answers[section.id].length > 0;
      }

      function countWords(text) {
        return text && text.trim() !== '' ? text.trim().split(/\s+/).length : 0;
      }

      function renderAll() {
        renderTopTiles();
        const section = exam.sections[state.sectionIndex];
        if (passageTitleEl) passageTitleEl.textContent = section.passageTitle;
        
        if (state.showResults) {
          renderResults();
          return;
        }
        
        renderWritingSection();
      }

      function renderWritingSection() {
        const section = exam.sections[state.sectionIndex];
        
        if (passageContentEl) {
          passageContentEl.innerHTML = `
            <div class="writing-task">
              <div class="writing-prompt">${section.writingTask.prompt}</div>
              <div class="instructions" style="border:1px solid #e1e8f6; padding:10px; margin:10px 0; border-radius:6px; background:#ffffff;">Sie haben den oben genannten Staubsauger erworben. Leider gibt es mehrere Probleme mit diesem Ger√§t. 
Schreiben Sie eine M√§ngelr√ºge an den Hersteller, ohne gleich mit dem Anwalt zu drohen.</div>
              <div class="writing-requirements">
                <h4>Schreiben Sie in Ihrer E-Mail:</h4>
                <ul>
                  ${section.writingTask.requirements.map(req => `<li>${req}</li>`).join('')}
                </ul>
              </div>
              <div class="instructions">
                Schreiben Sie eine E-Mail (ca. 150-200 W√∂rter). Achten Sie auf den Textaufbau (Anrede, Einleitung, Hauptteil, Schluss) und eine angemessene Formulierung.
              </div>
            </div>
          `;
        }
        
        const currentAnswer = state.answers[section.id] || '';
        const wordCount = countWords(currentAnswer);
        
        if (writingContainer) {
          writingContainer.innerHTML = `
            <div class="writing-area">
              <textarea 
                class="writing-textarea" 
                placeholder="Schreiben Sie hier Ihre E-Mail..."
                oninput="window.schreibenApp.updateWritingAnswer('${section.id}', this.value)"
              >${currentAnswer}</textarea>
              <div class="word-counter">
                W√∂rter: <span class="count">${wordCount}</span>
              </div>
            </div>
          `;
        }
      }

      function updateWritingAnswer(sectionId, text) {
        state.answers[sectionId] = text;
        try { 
          localStorage.setItem('schreibenAnswers', JSON.stringify({
            content: state.answers[sectionId],
            wordCount: countWords(state.answers[sectionId])
          })); 
        } catch(e) {}
        
        const wordCount = countWords(text);
        const counter = document.querySelector('.word-counter .count');
        if (counter) counter.textContent = wordCount;
      }

      function renderResults() {
        let resultsHTML = `<h2>Ergebnisse</h2>`;
        
        exam.sections.forEach(section => {
          resultsHTML += `<div class="writing-task"><h3>${section.title}</h3>`;
          
          const userAnswer = state.answers[section.id];
          const wordCount = countWords(userAnswer);
          
          resultsHTML += `
            <div class="writing-requirements">
              <h4>Ihre Antwort (${wordCount} W√∂rter):</h4>
              <div style="white-space: pre-wrap; background: white; padding: 15px; border-radius: 6px; border: 1px solid #e1e8f6; margin-top: 10px;">${userAnswer || 'Keine Antwort'}</div>
            </div>
          `;
          
          resultsHTML += `</div>`;
        });
        
        if (passageContentEl) passageContentEl.innerHTML = resultsHTML;
        if (writingContainer) writingContainer.innerHTML = '';
      }

      // Event Listeners
      const prevBtn = document.getElementById('prevBtn-schreiben');
      const nextBtn = document.getElementById('nextBtn-schreiben-footer');
      const resultBtn = document.getElementById('resultBtn-schreiben');
      const resetBtn = document.getElementById('resetBtn-schreiben');
      const saveBtn = document.getElementById('saveBtn-schreiben');
      const submitBtn = document.getElementById('submitBtn-schreiben');
      const nextBtnMain = document.getElementById('nextBtn-schreiben');
      
      if (prevBtn) {
        prevBtn.addEventListener('click', () => {
          if (state.sectionIndex > 0) {
            state.sectionIndex--;
            state.showResults = false;
            renderAll();
          }
        });
      }

      if (nextBtn) {
        nextBtn.addEventListener('click', () => {
          if (state.sectionIndex < exam.sections.length - 1) {
            state.sectionIndex++;
            state.showResults = false;
            renderAll();
          }
        });
      }

      if (resultBtn) {
        resultBtn.addEventListener('click', () => {
          state.showResults = !state.showResults;
          renderAll();
        });
      }

      if (resetBtn) {
        resetBtn.addEventListener('click', () => {
          if (confirm('M√∂chten Sie wirklich von neu beginnen? Alle Antworten werden gel√∂scht.')) {
            state.answers = {};
            state.showResults = false;
            resetTimer();
            renderAll();
          }
        });
      }

      if (saveBtn) {
        saveBtn.addEventListener('click', () => {
          if (statusText) {
            statusText.textContent = 'Gespeichert';
            setTimeout(() => { 
              if (statusText) statusText.textContent = 'Nicht gespeichert'; 
            }, 2000);
          }
        });
      }

      if (submitBtn) {
        submitBtn.addEventListener('click', () => {
          if (confirm('M√∂chten Sie die Pr√ºfung wirklich abgeben?')) {
            state.showResults = true;
            renderAll();
          }
        });
      }

      if (nextBtnMain) {
        nextBtnMain.addEventListener('click', () => {
          showPage('ergebnisse-page');
        });
      }

      // Initialize
      updateTimerDisplay();
      renderAll();
      startTimer();
      
      window._schreibenState = state;
      window.schreibenApp = {
        updateWritingAnswer: updateWritingAnswer
      };
    }

    // ===== ERGEBNISSE PAGE FUNCTIONALITY =====
    const CORRECT_ANSWERS = {
      lesen: {
        "text1": "c",
        "text2": "d",
        "text3": "f",
        "text4": "g",
        "text5": "i",
        "s2q1": "s2q1o2",
        "s2q2": "s2q2o1",
        "s2q3": "s2q3o3",
        "s2q4": "s2q4o3",
        "s2q5": "s2q5o3",
        "11": "L",
        "12": "J",
        "13": "A",
        "14": "H",
        "15": "K",
        "16": "C",
        "17": "D",
        "18": "I",
        "19": "E",
        "20": "F",
        "21": "√ºber",
        "22": "au√üerdem",
        "23": "nehmen",
        "24": "da",
        "25": "davon",
        "26": "gesprochen",
        "27": "dass",
        "28": "sich",
        "29": "die",
        "30": "jedenfalls",
        "31": "Flut",
        "32": "recht",
        "33": "aber",
        "34": "stellt",
        "35": "Diesen",
        "36": "meisten",
        "37": "Korrekt",
        "38": "unlogische",
        "39": "unterscheiden",
        "40": "somit"
      },
      hoeren: {
        "41": "richtig",
        "42": "falsch",
        "43": "falsch",
        "44": "falsch",
        "45": "richtig",
        "46": "falsch",
        "47": "richtig",
        "48": "falsch",
        "49": "richtig",
        "50": "richtig",
        "51": "falsch",
        "52": "falsch",
        "53": "richtig",
        "54": "falsch",
        "55": "richtig",
        "56": "richtig",
        "57": "falsch",
        "58": "falsch",
        "59": "falsch",
        "60": "richtig"
      }
    };

    function initErgebnissePage() {
      const CONFIG = {
        totals: { 
          lesen: 105, 
          hoeren: 75, 
          schreiben: 45, 
          gesamt: 225 
        }
      };

      function readExamResults() {
        try {
          const lesen = {};
          const hoeren = {};
          const schreiben = { content: '', wordCount: 0 };

          try {
            if (window._lesenState && window._lesenState.answers) {
              Object.keys(window._lesenState.answers).forEach(k => {
                lesen[k] = window._lesenState.answers[k];
              });
            }
          } catch (e) {}

          try {
            if (window._hoerenState && window._hoerenState.answers) {
              Object.keys(window._hoerenState.answers).forEach(sectionId => {
                const sec = window._hoerenState.answers[sectionId] || {};
                Object.keys(sec).forEach(q => {
                  hoeren[q] = sec[q];
                });
              });
            }
          } catch (e) {}

          try {
            if (window._schreibenState && window._schreibenState.answers) {
              const answers = window._schreibenState.answers;
              if (answers['s1']) {
                schreiben.content = answers['s1'];
              } else {
                const keys = Object.keys(answers);
                if (keys.length > 0) schreiben.content = answers[keys[0]] || '';
              }
              schreiben.wordCount = schreiben.content ? schreiben.content.trim().split(/\s+/).filter(Boolean).length : 0;
            }
          } catch (e) {}

          try {
            if (Object.keys(lesen).length === 0) {
              const storedL = localStorage.getItem('lesenAnswers');
              if (storedL) Object.assign(lesen, JSON.parse(storedL));
            }
          } catch (e) {}

          try {
            if (Object.keys(hoeren).length === 0) {
              const storedH = localStorage.getItem('hoerenAnswers');
              if (storedH) {
                const parsed = JSON.parse(storedH);
                Object.keys(parsed).forEach(sectionId => {
                  const sec = parsed[sectionId] || {};
                  Object.keys(sec).forEach(q => {
                    hoeren[q] = sec[q];
                  });
                });
              }
            }
          } catch (e) {}

          try {
            if (!schreiben.content) {
              const storedS = localStorage.getItem('schreibenAnswers');
              if (storedS) {
                const obj = JSON.parse(storedS);
                schreiben.content = obj.content || '';
                schreiben.wordCount = obj.wordCount || (schreiben.content ? schreiben.content.trim().split(/\s+/).filter(Boolean).length : 0);
              }
            }
          } catch (e) {}

          return { hoeren, lesen, schreiben };
        } catch (e) {
          return { hoeren: {}, lesen: {}, schreiben: {} };
        }
      }

      function calculateLesenScore(answers) {
        let correctCount = 0;
        let totalQuestions = 0;
        
        Object.keys(CORRECT_ANSWERS.lesen).forEach(key => {
          totalQuestions++;
          const userAnswer = answers[key] || '-';
          const correctAnswer = CORRECT_ANSWERS.lesen[key];
          if (String(userAnswer).toLowerCase() === String(correctAnswer).toLowerCase()) {
            correctCount++;
          }
        });
        
        return (correctCount / totalQuestions) * CONFIG.totals.lesen;
      }

      function calculateHoerenScore(answers) {
        let correctCount = 0;
        let totalQuestions = 0;
        
        Object.keys(CORRECT_ANSWERS.hoeren).forEach(key => {
          totalQuestions++;
          const userAnswer = String(answers[key] || '-').toLowerCase();
          const correctAnswer = CORRECT_ANSWERS.hoeren[key].toLowerCase();
          if (userAnswer === correctAnswer || 
              (correctAnswer === 'richtig' && ['richtig', 'true', 'ja'].includes(userAnswer)) ||
              (correctAnswer === 'falsch' && ['falsch', 'false', 'nein'].includes(userAnswer))) {
            correctCount++;
          }
        });
        
        return (correctCount / totalQuestions) * CONFIG.totals.hoeren;
      }

      function renderResults() {
        const st = readExamResults();
        const tiles = document.getElementById('topTiles-ergebnisse');
        const details = document.getElementById('details-ergebnisse');
        const summary = document.getElementById('finalSummary-ergebnisse');
        
        const lesenScore = calculateLesenScore(st.lesen);
        const hoerenScore = calculateHoerenScore(st.hoeren);
        const sScoreRaw = localStorage.getItem('schreibenScore');
        const sScore = sScoreRaw ? Number(sScoreRaw) : 0;
        
        if (tiles) {
          tiles.innerHTML = `
            <div class="results-tile">
              <h3>Lesen</h3>
              <div class="score">${lesenScore.toFixed(2)} / ${CONFIG.totals.lesen} Punkte</div>
              <div class="small-muted">(${(lesenScore / CONFIG.totals.lesen * 100).toFixed(2)} %)</div>
            </div>
            <div class="results-tile">
              <h3>H√∂ren</h3>
              <div class="score">${hoerenScore.toFixed(2)} / ${CONFIG.totals.hoeren} Punkte</div>
              <div class="small-muted">(${(hoerenScore / CONFIG.totals.hoeren * 100).toFixed(2)} %)</div>
            </div>
            <div class="results-tile">
              <h3>Schreiben</h3>
              <div class="score" id="schreibenScoreDisplay">${sScore.toFixed(2)} / ${CONFIG.totals.schreiben} Punkte</div>
              <div class="small-muted">Manuelle Eingabe</div>
            </div>`;
        }
        
        if (details) {
          details.innerHTML = `
            <div class="result-item">
              <h2>üìä Detaillierte Ergebnisse</h2>
              <div class="instructions">Hier sehen Sie eine detaillierte Auswertung Ihrer Pr√ºfung. Jede Frage wird mit Ihrer Antwort, der richtigen Antwort und dem Ergebnis angezeigt.</div>
            </div>`;
          
          // Lesen details
          details.innerHTML += `<div class="result-item"><h3>üìñ Leseverstehen</h3>`;
          let lesenDetails = '';
          Object.keys(CORRECT_ANSWERS.lesen).forEach(key => {
            const userAnswer = st.lesen[key] || '-';
            const correctAnswer = CORRECT_ANSWERS.lesen[key];
            const isCorrect = String(userAnswer).toLowerCase() === String(correctAnswer).toLowerCase();
            lesenDetails += `
              <div>${key}: ${userAnswer} ${isCorrect ? '‚úÖ' : '‚ùå'} (richtig: ${correctAnswer})</div>
            `;
          });
          details.innerHTML += lesenDetails + `</div>`;
          
          // Hoeren details
          details.innerHTML += `<div class="result-item"><h3>üëÇ H√∂rverstehen</h3>`;
          let hoerenDetails = '';
          Object.keys(CORRECT_ANSWERS.hoeren).forEach(key => {
            const userAnswer = st.hoeren[key] || '-';
            const correctAnswer = CORRECT_ANSWERS.hoeren[key];
            const userNorm = String(userAnswer).toLowerCase();
            const correctNorm = correctAnswer.toLowerCase();
            const isCorrect = userNorm === correctNorm || 
                             (correctNorm === 'richtig' && ['richtig', 'true', 'ja'].includes(userNorm)) ||
                             (correctNorm === 'falsch' && ['falsch', 'false', 'nein'].includes(userNorm));
            hoerenDetails += `
              <div>${key}: ${userAnswer} ${isCorrect ? '‚úÖ' : '‚ùå'} (richtig: ${correctAnswer})</div>
            `;
          });
          details.innerHTML += hoerenDetails + `</div>`;
          
          // Schreiben
          const txt = st.schreiben.content ? st.schreiben.content.replace(/</g, '&lt;').replace(/>/g, '&gt;') : '<span class="small-muted">Kein Text gefunden.</span>';
          const wc = st.schreiben.wordCount || '-';
          
          details.innerHTML += `
            <div class="result-item">
              <h3>‚úçÔ∏è Schreiben - Ihre Antwort</h3>
              <div class="small-muted">W√∂rter: ${wc}</div>
              <div style="margin-top:10px;padding:12px;background:#fff;border-radius:8px;border:1px solid #eef6ff;min-height:80px; white-space: pre-wrap;">${txt}</div>
              <div style="margin-top:15px;display:flex;gap:10px;align-items:center">
                <strong>Punkte (0‚Äì45):</strong>
                <input id="sInput" type="number" min="0" max="45" step="0.5" value="${sScore}" style="width: 100px;">
                <button id="saveS" class="results-btn">Speichern</button>
              </div>
            </div>`;
        }
        
        const total = (lesenScore + hoerenScore + sScore).toFixed(2);
        const percent = ((total / CONFIG.totals.gesamt) * 100).toFixed(2);
        
        if (summary) {
          summary.innerHTML = `
            <div class="left">
              <strong>Gesamtpunktzahl:</strong> ${total} / ${CONFIG.totals.gesamt} Punkte<br>
              <span class="small-muted">Lesen + H√∂ren + Schreiben</span>
            </div>
            <div class="right">
              <strong>Prozentsatz:</strong> ${percent} %
            </div>`;
        }

        const saveS = document.getElementById('saveS');
        if (saveS) {
          saveS.onclick = () => {
            const v = Number(document.getElementById('sInput').value) || 0;
            localStorage.setItem('schreibenScore', v);
            const display = document.getElementById('schreibenScoreDisplay');
            if (display) {
              display.textContent = `${v.toFixed(2)} / ${CONFIG.totals.schreiben} Punkte`;
            }
            
            const newTotal = (lesenScore + hoerenScore + v).toFixed(2);
            const newPercent = ((newTotal / CONFIG.totals.gesamt) * 100).toFixed(2);
            
            if (summary) {
              summary.innerHTML = `
                <div class="left">
                  <strong>Gesamtpunktzahl:</strong> ${newTotal} / ${CONFIG.totals.gesamt} Punkte<br>
                  <span class="small-muted">Lesen + H√∂ren + Schreiben</span>
                </div>
                <div class="right">
                  <strong>Prozentsatz:</strong> ${newPercent} %
                </div>`;
            }
          };
        }
      }

      const calcBtn = document.getElementById('calcBtn-ergebnisse');
      const backBtn = document.getElementById('backBtn-ergebnisse');
      
      if (calcBtn) {
        calcBtn.onclick = () => renderResults();
      }
      
      if (backBtn) {
        backBtn.onclick = (e) => {
          e.preventDefault();
          showPage('start-page');
        };
      }
      
      renderResults();
    }
  </script>
</body>
</html>